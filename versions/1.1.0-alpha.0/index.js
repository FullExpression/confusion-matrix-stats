!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var s in i)("object"==typeof exports?exports:e)[s]=i[s]}}(self,(function(){return(()=>{"use strict";var e={975:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AverageMethod=t.ConfusionMatrixSizes=t.ConfusionMatrix=void 0;class i{constructor(e){this.labels=new Array,this.matrix=new Array,this.normalizations=new Array,e&&(this.labels=this.deepCopy(e.labels),this.matrix=this.deepCopy(e.matrix)),this.validate()}setConfusionMatrix(e){e&&(this.labels=this.deepCopy(e.labels),this.matrix=this.deepCopy(e.matrix)),this.validate()}normalize(e=0,t=1,s){if(e>=t)throw new Error("Min value cannot be equal or greater than max value.");this.validate();const a=this.getMinAndMax();if(a){this.normalizations.push(new i(this));const r=a.min,l=a.max;for(let i=0;i<this.matrix.length;i++)for(let a=0;a<this.matrix[i].length;a++){const o=this.matrix[i][a];this.matrix[i][a]=(o-r)/(l-r)*(t-e)+e,null!=s&&(this.matrix[i][a]=+this.matrix[i][a].toFixed(s))}}}accuracy(e={average:s.Weighted}){return this.validate(),(null==e?void 0:e.label)&&(null==e?void 0:e.label.length)>0?this.labelAccuracy(e.label):this.matrixAccuracy(null==e?void 0:e.average)}labelAccuracy(e){this.validate();const{truePositive:t,trueNegative:i,falsePositive:s,falseNegative:a}=this.getConfusionMatrixClasses(e);return(t+i)/(t+i+s+a)||0}matrixAccuracy(e=s.Weighted){switch(this.validate(),e){case s.Micro:return this.microAccuracy();case s.Macro:return this.macroAccuracy();case s.Weighted:return this.weightedAccuracy()}}microAccuracy(){const{truePositive:e,trueNegative:t,falsePositive:i,falseNegative:s}=this.getSumConfusionMatrixClasses();return(e+t)/(e+t+i+s)||0}macroAccuracy(){let e=0;return this.labels.forEach((t=>e+=this.labelAccuracy(t))),e/this.labels.length||0}weightedAccuracy(){const e=this.getLabelsPredictionsSum(),t=this.getNumberOfPredictions();let i=0;return this.labels.forEach(((t,s)=>i+=this.labelAccuracy(t)*e[s])),i/t||0}missClassificationRate(e={average:s.Weighted}){return this.validate(),(null==e?void 0:e.label)&&(null==e?void 0:e.label.length)>0?this.labelMissClassificationRate(e.label):this.matrixMissClassificationRate(null==e?void 0:e.average)}labelMissClassificationRate(e){this.validate();const{truePositive:t,trueNegative:i,falsePositive:s,falseNegative:a}=this.getConfusionMatrixClasses(e);return(s+a)/(t+i+s+a)||0}matrixMissClassificationRate(e=s.Weighted){switch(this.validate(),e){case s.Micro:return this.microMissClassificationRate();case s.Macro:return this.macroMissClassificationRate();case s.Weighted:return this.weightedMissClassificationRate()}}microMissClassificationRate(){const{truePositive:e,trueNegative:t,falsePositive:i,falseNegative:s}=this.getSumConfusionMatrixClasses();return(i+s)/(e+t+i+s)||0}macroMissClassificationRate(){let e=0;return this.labels.forEach((t=>e+=this.labelMissClassificationRate(t))),e/this.labels.length||0}weightedMissClassificationRate(){const e=this.getLabelsPredictionsSum(),t=this.getNumberOfPredictions();let i=0;return this.labels.forEach(((t,s)=>i+=this.labelMissClassificationRate(t)*e[s])),i/t||0}precision(e={average:s.Weighted}){return this.validate(),(null==e?void 0:e.label)&&(null==e?void 0:e.label.length)>0?this.labelPrecision(e.label):this.matrixPrecision(null==e?void 0:e.average)}labelPrecision(e){this.validate();const{truePositive:t,falsePositive:i}=this.getConfusionMatrixClasses(e);return t/(t+i)||0}matrixPrecision(e=s.Weighted){switch(this.validate(),e){case s.Micro:return this.microPrecision();case s.Macro:return this.macroPrecision();case s.Weighted:return this.weightedPrecision()}}microPrecision(){const{truePositive:e,falsePositive:t}=this.getSumConfusionMatrixClasses();return e/(e+t)||0}macroPrecision(){let e=0;return this.labels.forEach((t=>e+=this.labelPrecision(t))),e/this.labels.length||0}weightedPrecision(){const e=this.getLabelsPredictionsSum(),t=this.getNumberOfPredictions();let i=0;return this.labels.forEach(((t,s)=>i+=this.labelPrecision(t)*e[s])),i/t||0}recall(e={average:s.Weighted}){return this.validate(),(null==e?void 0:e.label)&&(null==e?void 0:e.label.length)>0?this.labelRecall(e.label):this.matrixRecall(null==e?void 0:e.average)}labelRecall(e){this.validate();const{truePositive:t,falseNegative:i}=this.getConfusionMatrixClasses(e);return t/(t+i)||0}matrixRecall(e=s.Weighted){switch(this.validate(),e){case s.Micro:return this.microRecall();case s.Macro:return this.macroRecall();case s.Weighted:return this.weightedRecall()}}microRecall(){const{truePositive:e,falseNegative:t}=this.getSumConfusionMatrixClasses();return e/(e+t)||0}macroRecall(){let e=0;return this.labels.forEach((t=>e+=this.labelRecall(t))),e/this.labels.length||0}weightedRecall(){const e=this.getLabelsPredictionsSum(),t=this.getNumberOfPredictions();let i=0;return this.labels.forEach(((t,s)=>i+=this.labelRecall(t)*e[s])),i/t||0}specificity(e={average:s.Weighted}){return this.validate(),(null==e?void 0:e.label)&&(null==e?void 0:e.label.length)>0?this.labelSpecificity(e.label):this.matrixSpecificity(null==e?void 0:e.average)}matrixSpecificity(e=s.Weighted){switch(this.validate(),e){case s.Micro:return this.microSpecificity();case s.Macro:return this.macroSpecificity();case s.Weighted:return this.weightedSpecificity()}}microSpecificity(){const{trueNegative:e,falsePositive:t}=this.getSumConfusionMatrixClasses();return e/(e+t)||0}macroSpecificity(){let e=0;return this.labels.forEach((t=>e+=this.labelSpecificity(t))),e/this.labels.length||0}weightedSpecificity(){const e=this.getLabelsPredictionsSum(),t=this.getNumberOfPredictions();let i=0;return this.labels.forEach(((t,s)=>i+=this.labelSpecificity(t)*e[s])),i/t||0}labelSpecificity(e){this.validate();const{trueNegative:t,falsePositive:i}=this.getConfusionMatrixClasses(e);return t/(t+i)||0}f1Score(e){return this.validate(),(null==e?void 0:e.label)&&(null==e?void 0:e.label.length)>0?this.labelF1Score(e.label):this.matrixF1Score(null==e?void 0:e.average)}matrixF1Score(e=s.Weighted){switch(this.validate(),e){case s.Micro:return this.microF1Score();case s.Macro:return this.macroF1Score();case s.Weighted:return this.weightedF1Score()}}labelF1Score(e){this.validate();const t=this.precision({label:e}),i=this.recall({label:e});return t*i/(t+i)*2||0}microF1Score(){const e=this.microPrecision(),t=this.microRecall();return this.applyF1ScoreFormula(e,t)}macroF1Score(){let e=0;return this.labels.forEach((t=>e+=this.labelF1Score(t))),e/this.labels.length||0}weightedF1Score(){const e=this.getLabelsPredictionsSum(),t=this.getNumberOfPredictions();let i=0;return this.labels.forEach(((t,s)=>i+=this.labelF1Score(t)*e[s])),i/t||0}getAllMatrixClasses(){this.validate();const e=new Array;return this.labels.forEach((t=>e.push({label:t,confusionMatrixClasses:this.getConfusionMatrixClasses(t)}))),e}getSumConfusionMatrixClasses(){const e={truePositive:0,trueNegative:0,falsePositive:0,falseNegative:0};return this.getAllMatrixClasses().forEach((t=>{e.truePositive+=t.confusionMatrixClasses.truePositive,e.trueNegative+=t.confusionMatrixClasses.trueNegative,e.falsePositive+=t.confusionMatrixClasses.falsePositive,e.falseNegative+=t.confusionMatrixClasses.falseNegative})),e}getConfusionMatrixClasses(e){if(this.validate(),!e)throw new Error("A valid label should be passed.");const t=this.labels.findIndex((t=>t===e));if(-1==t)throw new Error("The label does not exists in the matrix.");const i=this.getNumberOfPredictions(),s=this.matrix[t][t],a=this.matrix[t].reduce(((e,t)=>e+t))-s;let r=0;for(let e=0;e<this.matrix.length;e++)r+=this.matrix[e][t];return r-=s,{truePositive:s,trueNegative:i-s-a-r,falsePositive:a,falseNegative:r}}revertNormalization(){if(this.normalizations.length>0){const e=this.normalizations.pop();if(e)return this.setConfusionMatrix(e),e}return null}clone(){const e=new i({labels:this.labels,matrix:this.matrix});return e.normalizations=this.deepCopy(this.normalizations),e}getMinAndMax(){let e=this.matrix[0][0],t=this.matrix[0][0];if(!e||!t)return null;for(let i of this.matrix)for(let s of i)t=t<s?s:t,e=e>s?s:e;return{min:e,max:t}}revertAllNormalizations(){this.normalizations&&this.normalizations.length>0&&this.setConfusionMatrix(this.normalizations[0])}getNumberOfPredictions(e){const t=this.getLabelsPredictionsSum();return e&&e.length>0?t[this.labels.findIndex((t=>t===e))]:t.reduce(((e,t)=>e+t))}getLabelsPredictionsSum(){let e=new Array(this.labels.length).fill(0,0,this.labels.length);return this.matrix.forEach((t=>t.forEach(((t,i)=>{e[i]+=t})))),e}validate(){if(this.labels.length!==this.matrix.length)throw new Error("The labels length should be equals to the matrix columns length.");for(let e=0;e<this.labels.length-1;e++)for(let t=e+1;t<this.labels.length;t++)if(this.labels[e]===this.labels[t])throw new Error(`The label ${this.labels[e]} appears more than once in the labels array.`);this.matrix.forEach((e=>{if(e.length!==this.matrix.length)throw new Error("The confusion matrix does not have the columns/rows length.")}))}deepCopy(e){return JSON.parse(JSON.stringify(e))}applyF1ScoreFormula(e,t){return e*t/(e+t)*2}}var s,a;t.ConfusionMatrix=i,(a=t.ConfusionMatrixSizes||(t.ConfusionMatrixSizes={})).Small="small",a.Medium="medium",a.Large="large",a.ExtraLarge="extra-large",function(e){e[e.Micro=0]="Micro",e[e.Macro=1]="Macro",e[e.Weighted=2]="Weighted"}(s=t.AverageMethod||(t.AverageMethod={}))},590:function(e,t,i){var s=this&&this.__createBinding||(Object.create?function(e,t,i,s){void 0===s&&(s=i),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,s){void 0===s&&(s=i),e[s]=t[i]}),a=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||s(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),a(i(975),t)}},t={};return function i(s){var a=t[s];if(void 0!==a)return a.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,i),r.exports}(590)})()}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AZnVsbGV4cHJlc3Npb24vY29uZnVzaW9uLW1hdHJpeC1zdGF0cy93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vQGZ1bGxleHByZXNzaW9uL2NvbmZ1c2lvbi1tYXRyaXgtc3RhdHMvLi9kaXN0L2NvbmZ1c2lvbi1tYXRyaXgubW9kZWxzLmpzIiwid2VicGFjazovL0BmdWxsZXhwcmVzc2lvbi9jb25mdXNpb24tbWF0cml4LXN0YXRzLy4vZGlzdC9pbmRleC5qcyIsIndlYnBhY2s6Ly9AZnVsbGV4cHJlc3Npb24vY29uZnVzaW9uLW1hdHJpeC1zdGF0cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9AZnVsbGV4cHJlc3Npb24vY29uZnVzaW9uLW1hdHJpeC1zdGF0cy93ZWJwYWNrL3N0YXJ0dXAiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwiYSIsImkiLCJzZWxmIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ2YWx1ZSIsIkF2ZXJhZ2VNZXRob2QiLCJDb25mdXNpb25NYXRyaXhTaXplcyIsIkNvbmZ1c2lvbk1hdHJpeCIsImNvbmZ1c2lvbk1hdHJpeCIsInRoaXMiLCJsYWJlbHMiLCJBcnJheSIsIm1hdHJpeCIsIm5vcm1hbGl6YXRpb25zIiwiZGVlcENvcHkiLCJ2YWxpZGF0ZSIsIm1pbiIsIm1heCIsImZyYWN0aW9uRGlnaXRzIiwiRXJyb3IiLCJtYXRyaXhNaW5NYXgiLCJnZXRNaW5BbmRNYXgiLCJwdXNoIiwibWluWCIsIm1heFgiLCJsZW5ndGgiLCJqIiwieCIsInVuZGVmaW5lZCIsInRvRml4ZWQiLCJjb25maWd1cmF0aW9uIiwiYXZlcmFnZSIsIldlaWdodGVkIiwibGFiZWwiLCJsYWJlbEFjY3VyYWN5IiwibWF0cml4QWNjdXJhY3kiLCJ0cnVlUG9zaXRpdmUiLCJ0cnVlTmVnYXRpdmUiLCJmYWxzZVBvc2l0aXZlIiwiZmFsc2VOZWdhdGl2ZSIsImdldENvbmZ1c2lvbk1hdHJpeENsYXNzZXMiLCJNaWNybyIsIm1pY3JvQWNjdXJhY3kiLCJNYWNybyIsIm1hY3JvQWNjdXJhY3kiLCJ3ZWlnaHRlZEFjY3VyYWN5IiwiZ2V0U3VtQ29uZnVzaW9uTWF0cml4Q2xhc3NlcyIsInN1bSIsImZvckVhY2giLCJzdW1MYWJlbHMiLCJnZXRMYWJlbHNQcmVkaWN0aW9uc1N1bSIsIm51bWJlck9mUHJlZGljdGlvbnMiLCJnZXROdW1iZXJPZlByZWRpY3Rpb25zIiwiaW5kZXgiLCJsYWJlbE1pc3NDbGFzc2lmaWNhdGlvblJhdGUiLCJtYXRyaXhNaXNzQ2xhc3NpZmljYXRpb25SYXRlIiwibWljcm9NaXNzQ2xhc3NpZmljYXRpb25SYXRlIiwibWFjcm9NaXNzQ2xhc3NpZmljYXRpb25SYXRlIiwid2VpZ2h0ZWRNaXNzQ2xhc3NpZmljYXRpb25SYXRlIiwibGFiZWxQcmVjaXNpb24iLCJtYXRyaXhQcmVjaXNpb24iLCJtaWNyb1ByZWNpc2lvbiIsIm1hY3JvUHJlY2lzaW9uIiwid2VpZ2h0ZWRQcmVjaXNpb24iLCJsYWJlbFJlY2FsbCIsIm1hdHJpeFJlY2FsbCIsIm1pY3JvUmVjYWxsIiwibWFjcm9SZWNhbGwiLCJ3ZWlnaHRlZFJlY2FsbCIsImxhYmVsU3BlY2lmaWNpdHkiLCJtYXRyaXhTcGVjaWZpY2l0eSIsIm1pY3JvU3BlY2lmaWNpdHkiLCJtYWNyb1NwZWNpZmljaXR5Iiwid2VpZ2h0ZWRTcGVjaWZpY2l0eSIsImxhYmVsRjFTY29yZSIsIm1hdHJpeEYxU2NvcmUiLCJtaWNyb0YxU2NvcmUiLCJtYWNyb0YxU2NvcmUiLCJ3ZWlnaHRlZEYxU2NvcmUiLCJwcmVjaXNpb24iLCJyZWNhbGwiLCJhcHBseUYxU2NvcmVGb3JtdWxhIiwiYWxsIiwiY29uZnVzaW9uTWF0cml4Q2xhc3NlcyIsImNsYXNzZXNTdW0iLCJnZXRBbGxNYXRyaXhDbGFzc2VzIiwicG9zaXRpb24iLCJmaW5kSW5kZXgiLCJlbGVtZW50IiwicmVkdWNlIiwicHJldmlvdXMiLCJuZXh0IiwiY20iLCJwb3AiLCJzZXRDb25mdXNpb25NYXRyaXgiLCJjbG9uZU9iaiIsImxpbmUiLCJ2YWwiLCJwcmV2IiwiZmlsbCIsImFycmF5Iiwib2JqZWN0IiwiSlNPTiIsInBhcnNlIiwic3RyaW5naWZ5IiwiX19jcmVhdGVCaW5kaW5nIiwiY3JlYXRlIiwibyIsIm0iLCJrIiwiazIiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiX19leHBvcnRTdGFyIiwicCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iXSwibWFwcGluZ3MiOiJDQUFBLFNBQTJDQSxFQUFNQyxHQUNoRCxHQUFzQixpQkFBWkMsU0FBMEMsaUJBQVhDLE9BQ3hDQSxPQUFPRCxRQUFVRCxTQUNiLEdBQXFCLG1CQUFYRyxRQUF5QkEsT0FBT0MsSUFDOUNELE9BQU8sR0FBSUgsT0FDUCxDQUNKLElBQUlLLEVBQUlMLElBQ1IsSUFBSSxJQUFJTSxLQUFLRCxHQUF1QixpQkFBWkosUUFBdUJBLFFBQVVGLEdBQU1PLEdBQUtELEVBQUVDLElBUHhFLENBU0dDLE1BQU0sV0FDVCxNLHNDQ1RBQyxPQUFPQyxlQUFlUixFQUFTLGFBQWMsQ0FBRVMsT0FBTyxJQUN0RFQsRUFBUVUsY0FBZ0JWLEVBQVFXLHFCQUF1QlgsRUFBUVkscUJBQWtCLEVBWWpGLE1BQU1BLEVBZUYsWUFBWUMsR0FFUkMsS0FBS0MsT0FBUyxJQUFJQyxNQU1sQkYsS0FBS0csT0FBUyxJQUFJRCxNQUVsQkYsS0FBS0ksZUFBaUIsSUFBSUYsTUFDdEJILElBQ0FDLEtBQUtDLE9BQVNELEtBQUtLLFNBQVNOLEVBQWdCRSxRQUM1Q0QsS0FBS0csT0FBU0gsS0FBS0ssU0FBU04sRUFBZ0JJLFNBRWhESCxLQUFLTSxXQU1ULG1CQUFtQlAsR0FDWEEsSUFDQUMsS0FBS0Ms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QkYsR0FBVUgsS0FBS3pILEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVM0SCxHQUdwRTNILEVBQU9ELFFDbEJXNEgsQ0FBb0IsTSIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSB7XG5cdFx0dmFyIGEgPSBmYWN0b3J5KCk7XG5cdFx0Zm9yKHZhciBpIGluIGEpICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgPyBleHBvcnRzIDogcm9vdClbaV0gPSBhW2ldO1xuXHR9XG59KShzZWxmLCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuQXZlcmFnZU1ldGhvZCA9IGV4cG9ydHMuQ29uZnVzaW9uTWF0cml4U2l6ZXMgPSBleHBvcnRzLkNvbmZ1c2lvbk1hdHJpeCA9IHZvaWQgMDtcbi8qKlxuICogQ29uZnVzaW9uIG1hdHJpeCBtb2RlbCB3aGljaCBzdW1tYXJpemVzIHRoZSBwcmVkaWN0aW9uIHJlc3VsdHMgb24gYSBjbGFzc2lmaWNhdGlvbiBwcm9ibGVtLlxuICpcbiAqIFRoZSBudW1iZXIgb2YgY29ycmVjdC9pbmNvcnJlY3QgcHJlZGljdGlvbnMgYXJlIHN1bW1hcml6ZWQgd2l0aCBjb3VudCB2YWx1ZXMgYW5kIGdyb3VwZWQgYnkgZWFjaCBjbGFzcy5cbiAqXG4gKiBUaGUgbWF0cml4IGNvbHVtbnMgcmVwcmVzZW50cyB0aGUgdHJ1ZSBjbGFzc2VzIGFuZCB0aGUgY29sdW1ucyB0aGUgcHJlZGljdGVkIGNsYXNzZXMuXG4gKlxuICogQG5vdGUgQ29uc3VsdCBbd2lraXBlZGlhXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Db25mdXNpb25fbWF0cml4KSBhbmQgW0pveWR3aXAgTW9oYWpvbiwgMjAyMF0oaHR0cHM6Ly90b3dhcmRzZGF0YXNjaWVuY2UuY29tL2NvbmZ1c2lvbi1tYXRyaXgtZm9yLXlvdXItbXVsdGktY2xhc3MtbWFjaGluZS1sZWFybmluZy1tb2RlbC1mZjlhYTNiZjc4MjYpXG4gKiBmb3IgbW9yZSBpbmZvcm1hdGlvbiByZWdhcmRpbmcgdGVybWlub2xvZ3ksIGZvcm11bGFzIGFuZCBvdGhlciB0aGVvcmV0aWNhbCBjb25jZXB0cy5cbiAqXG4gKi9cbmNsYXNzIENvbmZ1c2lvbk1hdHJpeCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBuZXcgaW5zdGFuY2Ugb2YgY29uZnVzaW9uIG1hdHJpeC5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogPHByZT48Y29kZT5cbiAgICAgKiBjb25zdCBjb25mdXNpb25NYXRyaXggPSBuZXcgQ29uZnVzaW9uTWF0cml4KHtcbiAgICAgKiAgIGxhYmVsczogW1wiSGFwcGluZXNzXCIsIFwiU2FkbmVzc1wiXSxcbiAgICAgKiAgIG1hdHJpeDpcbiAgICAgKiAgICAgICBbWzEsMl0sXG4gICAgICogICAgICAgWzMsNF1dXG4gICAgICogICB9KTtcbiAgICAgKiA8L2NvZGU+PHByZT5cbiAgICAgKiBAcGFyYW0gY29uZnVzaW9uTWF0cml4XG4gICAgICovXG4gICAgY29uc3RydWN0b3IoY29uZnVzaW9uTWF0cml4KSB7XG4gICAgICAgIC8qKiBDb25mdXNpb24gbWF0cml4IGxhYmVscyAqL1xuICAgICAgICB0aGlzLmxhYmVscyA9IG5ldyBBcnJheSgpO1xuICAgICAgICAvKipcbiAgICAgICAgICogQ29uZnVzaW9uIG1hdHJpeCB2YWx1ZXMuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZSBjb2x1bW5zIHJlcHJlc2VudHMgdGhlIHRydWUgY2xhc3NlcyBhbmQgdGhlIGNvbHVtbnMgdGhlIHByZWRpY3RlZCBjbGFzc2VzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tYXRyaXggPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgLyoqIE5vcm1hbGl6YXRpb24gaGlzdG9yeSB2YWx1ZXMuICovXG4gICAgICAgIHRoaXMubm9ybWFsaXphdGlvbnMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgaWYgKGNvbmZ1c2lvbk1hdHJpeCkge1xuICAgICAgICAgICAgdGhpcy5sYWJlbHMgPSB0aGlzLmRlZXBDb3B5KGNvbmZ1c2lvbk1hdHJpeC5sYWJlbHMpO1xuICAgICAgICAgICAgdGhpcy5tYXRyaXggPSB0aGlzLmRlZXBDb3B5KGNvbmZ1c2lvbk1hdHJpeC5tYXRyaXgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmFsaWRhdGUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgY29uZnVzaW9uIG1hdHJpeCB2YWx1ZSBiYXNlZCBvbiBhbm90aGVyIGNvbmZ1c2lvbiBtYXRyaXguXG4gICAgICogQHBhcmFtIGNvbmZ1c2lvbk1hdHJpeCBUaGUgY29uZnVzaW9uIG1hdHJpeC5cbiAgICAgKi9cbiAgICBzZXRDb25mdXNpb25NYXRyaXgoY29uZnVzaW9uTWF0cml4KSB7XG4gICAgICAgIGlmIChjb25mdXNpb25NYXRyaXgpIHtcbiAgICAgICAgICAgIHRoaXMubGFiZWxzID0gdGhpcy5kZWVwQ29weShjb25mdXNpb25NYXRyaXgubGFiZWxzKTtcbiAgICAgICAgICAgIHRoaXMubWF0cml4ID0gdGhpcy5kZWVwQ29weShjb25mdXNpb25NYXRyaXgubWF0cml4KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZhbGlkYXRlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE5vcm1hbGl6ZXMgYWxsIHZhbHVlcyBvZiB0aGUgbWF0cml4IGJldHdlZW4gdHdvIGdpdmVuIHZhbHVlcy5cbiAgICAgKlxuICAgICAqIEFsbCBub3JtYWxpemF0aW9ucyB3aWxsIGJlIHNhdmVkIGluIGhpc3RvcnkgYW5kIGl0IGlzIHBvc3NpYmxlIHRvIHJldmVydCBsYXN0IG5vcm1hbGl6YXRpb25zXG4gICAgICogYnkgY2FsbGluZyB0aGUgZnVuY3Rpb24gQHNlZSB7QGxpbmsgQ29uZnVzaW9uTWF0cml4LnJldmVydE5vcm1hbGl6YXRpb259LlxuICAgICAqXG4gICAgICogQG5vdGUgQ2FuIGJlIHNwZWNpYWwgdXRpbCBpZiB5b3Ugd2FudCB0byBjb252ZXJ0IHRoZSB2YWx1ZXMgdG8gcGVyY2VudGFnZSBvciBiZXR3ZWVuIFswLCAxXS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBtaW4gTWluaW11bSB2YWx1ZSBvZiB0aGUgbm9ybWFsaXplZCByYW5nZSB2YWx1ZXMgW21pbiwgbWF4XS5cbiAgICAgKiBAcGFyYW0gbWF4IE1heGltdW0gdmFsdWUgb2YgdGhlIG5vcm1hbGl6ZWQgcmFuZ2UgdmFsdWVzIFttaW4sIG1heF0uXG4gICAgICogQHBhcmFtIGZyYWN0aW9uRGlnaXRzIOKAlCBOdW1iZXIgb2YgZGlnaXRzIGFmdGVyIHRoZSBkZWNpbWFsIHBvaW50LiBNdXN0IGJlIGluIHRoZSByYW5nZSAwIC0gMjAsIGluY2x1c2l2ZS5cbiAgICAgKi9cbiAgICBub3JtYWxpemUobWluID0gMCwgbWF4ID0gMSwgZnJhY3Rpb25EaWdpdHMpIHtcbiAgICAgICAgaWYgKG1pbiA+PSBtYXgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWluIHZhbHVlIGNhbm5vdCBiZSBlcXVhbCBvciBncmVhdGVyIHRoYW4gbWF4IHZhbHVlLicpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmFsaWRhdGUoKTtcbiAgICAgICAgY29uc3QgbWF0cml4TWluTWF4ID0gdGhpcy5nZXRNaW5BbmRNYXgoKTtcbiAgICAgICAgaWYgKG1hdHJpeE1pbk1heCkge1xuICAgICAgICAgICAgdGhpcy5ub3JtYWxpemF0aW9ucy5wdXNoKG5ldyBDb25mdXNpb25NYXRyaXgodGhpcykpO1xuICAgICAgICAgICAgY29uc3QgbWluWCA9IG1hdHJpeE1pbk1heC5taW47XG4gICAgICAgICAgICBjb25zdCBtYXhYID0gbWF0cml4TWluTWF4Lm1heDtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5tYXRyaXgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMubWF0cml4W2ldLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHggPSB0aGlzLm1hdHJpeFtpXVtqXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXRyaXhbaV1bal0gPSAoKG1heCAtIG1pbikgKiAoKHggLSBtaW5YKSAvIChtYXhYIC0gbWluWCkpKSArIG1pbjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZyYWN0aW9uRGlnaXRzICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXRyaXhbaV1bal0gPSArdGhpcy5tYXRyaXhbaV1bal0udG9GaXhlZChmcmFjdGlvbkRpZ2l0cyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQWNjdXJhY3kgZ2l2ZXMgdGhlIGZyYWN0aW9uIG9mIHRvdGFsIHByZWRpY3Rpb25zIHdoaWNoIHdlcmUgY29ycmVjdGx5IGNsYXNzaWZpZWQuXG4gICAgICpcbiAgICAgKiBGb3JtdWxhOlxuICAgICAqXG4gICAgICogYWNjdXJhY3kgPSAoVFAgKyBUTikgLyAoVFAgKyBUTiArIEZQICsgRk4pXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29uZmlndXJhdGlvbiBTZXQgb2YgY29uZmlndXJhdGlvbnMgdXNlZCBvbiBhY2N1cmFjeSBjYWxjdWxhdGlvbnMuXG4gICAgICpcbiAgICAgKiBbW2NvbmZpZ3VyYXRpb24ubGFiZWxdXSA6IFRoZSBsYWJlbCBuYW1lIHdoaWNoIHdpbGwgYmUgdXNlZCB0byBjYWxjdWxhdGUgdGhlIGFjY3VyYWN5IHZhbHVlLlxuICAgICAqIElmIHVuZGVmaW5lZCBvciBudWxsLCB0aGUgYWNjdXJhY3kgdmFsdWUgd2lsbCBiZSBjYWxjdWxhdGVkIGZvciBhbGwgY29uZnVzaW9uIG1hdHJpeC5cbiAgICAgKlxuICAgICAqIFtbY29uZmlndXJhdGlvbi5hdmVyYWdlXV06IERlZmluZXMgd2hpY2ggdHlwZSBvZiBhdmVyYWdlIHNob3VsZCBiZSB1c2VkLiBUaGlzIGF2ZXJhZ2Ugd2lsbCBvbmx5IGJlIHRha2VuIGluIGFjY291bnQuXG4gICAgICogb24gbWF0cml4IGNhbGN1bGF0aW9ucyAod2hlbiBsYWJlbCA9IG51bGwgfHwgdW5kZWZpbmVkKS5cbiAgICAgKlxuICAgICAqIFtbY29uZmlndXJhdGlvbi5hdmVyYWdlLk1pY3JvXV06IENhbGN1bGF0ZXMgdGhlIFRQLCBUTiwgRlAgYW5kIEZOIGZvciB0aGUgbWF0cml4IGdsb2JhbGx5IGFuZCB0aGVuIGFwcGxpZXMgdGhlXG4gICAgICogYWNjdXJhY3kgZm9ybXVsYS5cbiAgICAgKlxuICAgICAqIFtbY29uZmlndXJhdGlvbi5hdmVyYWdlLk1hY3JvXV06IENhbGN1bGF0ZXMgYW5kIHN1bXMgdGhlIGFjY3VyYWN5IGZvciBlYWNoIGluZGl2aWR1YWwgbGFiZWwgYW5kIGRpdmlkZXMgZm9yXG4gICAgICogdGhlIG51bWJlciBvZiBsYWJlbHMuXG4gICAgICpcbiAgICAgKiBbW2NvbmZpZ3VyYXRpb24uYXZlcmFnZS5XZWlnaHRlZF1dOiBEZWZpbmVzIGlmIHRoZSBhY2N1cmFjeSBjYWxjdWxhdGlvbnMgc2hvdWxkIGJlIHdlaWdodGVkLiBUaGlzIG1lYW5zIHRoZSBsYWJlbHNcbiAgICAgKiB3aXRoIG1vcmUgcHJlZGljdGlvbnMgd2lsbCB3ZWlnaHQgbW9yZSBpbiB0aGUgZmluYWwgYWNjdXJhY3kgdmFsdWUgY29tcGFyaW5nIHdpdGggbGFiZWxzIHdpdGggbGVzcy5cbiAgICAgKiBwcmVkaWN0aW9ucy5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gVGhlIGFjY3VyYWN5IHZhbHVlLlxuICAgICAqL1xuICAgIGFjY3VyYWN5KGNvbmZpZ3VyYXRpb24gPSB7IGF2ZXJhZ2U6IEF2ZXJhZ2VNZXRob2QuV2VpZ2h0ZWQgfSkge1xuICAgICAgICB0aGlzLnZhbGlkYXRlKCk7XG4gICAgICAgIGlmICgoY29uZmlndXJhdGlvbiA9PT0gbnVsbCB8fCBjb25maWd1cmF0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25maWd1cmF0aW9uLmxhYmVsKSAmJiAoY29uZmlndXJhdGlvbiA9PT0gbnVsbCB8fCBjb25maWd1cmF0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25maWd1cmF0aW9uLmxhYmVsLmxlbmd0aCkgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sYWJlbEFjY3VyYWN5KGNvbmZpZ3VyYXRpb24ubGFiZWwpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLm1hdHJpeEFjY3VyYWN5KGNvbmZpZ3VyYXRpb24gPT09IG51bGwgfHwgY29uZmlndXJhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29uZmlndXJhdGlvbi5hdmVyYWdlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2l2ZXMgdGhlIGFjY3VyYWN5IHZhbHVlIGZvciBhIGdpdmVuIG1hdHJpeCBsYWJlbC5cbiAgICAgKlxuICAgICAqIEFjY3VyYWN5IGdpdmVzIHRoZSBmcmFjdGlvbiBvZiB0b3RhbCBwcmVkaWN0aW9ucyB3aGljaCB3ZXJlIGNvcnJlY3RseSBjbGFzc2lmaWVkLlxuICAgICAqXG4gICAgICogRm9ybXVsYTpcbiAgICAgKlxuICAgICAqIGFjY3VyYWN5ID0gKFRQICsgVE4pIC8gKFRQICsgVE4gKyBGUCArIEZOKVxuICAgICAqXG4gICAgICogQHBhcmFtIGxhYmVsIFRoZSBsYWJlbCB1c2VkIHRvIGdldCB0aGUgYWNjdXJhY3kgdmFsdWUuXG4gICAgICogQHJldHVybiBBY2N1cmFjeSB2YWx1ZSBmb3IgYSBnaXZlbiBsYWJlbC5cbiAgICAgKi9cbiAgICBsYWJlbEFjY3VyYWN5KGxhYmVsKSB7XG4gICAgICAgIHRoaXMudmFsaWRhdGUoKTtcbiAgICAgICAgY29uc3QgeyB0cnVlUG9zaXRpdmUsIHRydWVOZWdhdGl2ZSwgZmFsc2VQb3NpdGl2ZSwgZmFsc2VOZWdhdGl2ZSB9ID0gdGhpcy5nZXRDb25mdXNpb25NYXRyaXhDbGFzc2VzKGxhYmVsKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gKHRydWVQb3NpdGl2ZSArIHRydWVOZWdhdGl2ZSkgLyAodHJ1ZVBvc2l0aXZlICsgdHJ1ZU5lZ2F0aXZlICsgZmFsc2VQb3NpdGl2ZSArIGZhbHNlTmVnYXRpdmUpO1xuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdpdmVzIHRoZSBhY2N1cmFjeSB2YWx1ZSBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXgsIHRha2luZyBpbiBhY2NvdW50IGEgZ2l2ZW5cbiAgICAgKiBhdmVyYWdlIG1ldGhvZCBvZiBjYWxjdWxhdGlvbi5cbiAgICAgKlxuICAgICAqIEFjY3VyYWN5IGdpdmVzIHRoZSBmcmFjdGlvbiBvZiB0b3RhbCBwcmVkaWN0aW9ucyB3aGljaCB3ZXJlIGNvcnJlY3RseSBjbGFzc2lmaWVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIGF2ZXJhZ2UgRGVmaW5lcyB3aGljaCB0eXBlIG9mIGF2ZXJhZ2Ugc2hvdWxkIGJlIHVzZWQuIFRoaXMgYXZlcmFnZSB3aWxsIG9ubHkgYmUgdGFrZW4gaW4gYWNjb3VudC5cbiAgICAgKiBvbiBtYXRyaXggY2FsY3VsYXRpb25zICh3aGVuIGxhYmVsID0gbnVsbCB8fCB1bmRlZmluZWQpLlxuICAgICAqXG4gICAgICogW1thdmVyYWdlLk1pY3JvXV06IENhbGN1bGF0ZXMgdGhlIFRQLCBUTiwgRlAgYW5kIEZOIGZvciB0aGUgbWF0cml4IGdsb2JhbGx5IGFuZCB0aGVuIGFwcGxpZXMgdGhlXG4gICAgICogYWNjdXJhY3kgZm9ybXVsYS5cbiAgICAgKlxuICAgICAqIFtbYXZlcmFnZS5NYWNyb11dOiBDYWxjdWxhdGVzIGFuZCBzdW1zIHRoZSBhY2N1cmFjeSBmb3IgZWFjaCBpbmRpdmlkdWFsIGxhYmVsIGFuZCBkaXZpZGVzIGZvclxuICAgICAqIHRoZSBudW1iZXIgb2YgbGFiZWxzLlxuICAgICAqXG4gICAgICogW1thdmVyYWdlLldlaWdodGVkXV06IERlZmluZXMgaWYgdGhlIGFjY3VyYWN5IGNhbGN1bGF0aW9ucyBzaG91bGQgYmUgd2VpZ2h0ZWQuIFRoaXMgbWVhbnMgdGhlIGxhYmVsc1xuICAgICAqIHdpdGggbW9yZSBwcmVkaWN0aW9ucyB3aWxsIHdlaWdodCBtb3JlIGluIHRoZSBmaW5hbCBhY2N1cmFjeSB2YWx1ZSBjb21wYXJpbmcgd2l0aCBsYWJlbHMgd2l0aCBsZXNzLlxuICAgICAqIHByZWRpY3Rpb25zLlxuICAgICAqXG4gICAgICogQHJldHVybiBUaGUgYWNjdXJhY3kgdmFsdWUuXG4gICAgICovXG4gICAgbWF0cml4QWNjdXJhY3koYXZlcmFnZSA9IEF2ZXJhZ2VNZXRob2QuV2VpZ2h0ZWQpIHtcbiAgICAgICAgdGhpcy52YWxpZGF0ZSgpO1xuICAgICAgICBzd2l0Y2ggKGF2ZXJhZ2UpIHtcbiAgICAgICAgICAgIGNhc2UgQXZlcmFnZU1ldGhvZC5NaWNybzogcmV0dXJuIHRoaXMubWljcm9BY2N1cmFjeSgpO1xuICAgICAgICAgICAgY2FzZSBBdmVyYWdlTWV0aG9kLk1hY3JvOiByZXR1cm4gdGhpcy5tYWNyb0FjY3VyYWN5KCk7XG4gICAgICAgICAgICBjYXNlIEF2ZXJhZ2VNZXRob2QuV2VpZ2h0ZWQ6IHJldHVybiB0aGlzLndlaWdodGVkQWNjdXJhY3koKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAqIEdpdmVzIHRoZSBhY2N1cmFjeSB2YWx1ZSBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXgsIHRha2luZyBpbiBhY2NvdW50IHRoZSBtaWNybyBhdmVyYWdlIG1ldGhvZC5cbiAgICAqXG4gICAgKiBBY2N1cmFjeSBnaXZlcyB0aGUgZnJhY3Rpb24gb2YgdG90YWwgcHJlZGljdGlvbnMgd2hpY2ggd2VyZSBjb3JyZWN0bHkgY2xhc3NpZmllZC5cbiAgICAqXG4gICAgKiBUaGUgbWljcm8gYXZlcmFnZSBtZXRob2QgY2FsY3VsYXRlcyBhbmQgc3VtcyB0aGUgYWNjdXJhY3kgZm9yIGVhY2ggaW5kaXZpZHVhbCBsYWJlbCBhbmQgZGl2aWRlcyBmb3JcbiAgICAqIHRoZSBudW1iZXIgb2YgbGFiZWxzLlxuICAgICpcbiAgICAqIEByZXR1cm4gVGhlIG1pY3JvIGFjY3VyYWN5IHZhbHVlLlxuICAgICovXG4gICAgbWljcm9BY2N1cmFjeSgpIHtcbiAgICAgICAgY29uc3QgeyB0cnVlUG9zaXRpdmUsIHRydWVOZWdhdGl2ZSwgZmFsc2VQb3NpdGl2ZSwgZmFsc2VOZWdhdGl2ZSB9ID0gdGhpcy5nZXRTdW1Db25mdXNpb25NYXRyaXhDbGFzc2VzKCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9ICh0cnVlUG9zaXRpdmUgKyB0cnVlTmVnYXRpdmUpIC8gKHRydWVQb3NpdGl2ZSArIHRydWVOZWdhdGl2ZSArIGZhbHNlUG9zaXRpdmUgKyBmYWxzZU5lZ2F0aXZlKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdCB8fCAwO1xuICAgIH1cbiAgICAvKipcbiAgICAqIEdpdmVzIHRoZSBhY2N1cmFjeSB2YWx1ZSBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXgsIHRha2luZyBpbiBhY2NvdW50IHRoZSBtYWNybyBhdmVyYWdlIG1ldGhvZC5cbiAgICAqXG4gICAgKiBBY2N1cmFjeSBnaXZlcyB0aGUgZnJhY3Rpb24gb2YgdG90YWwgcHJlZGljdGlvbnMgd2hpY2ggd2VyZSBjb3JyZWN0bHkgY2xhc3NpZmllZC5cbiAgICAqXG4gICAgKiBUaGUgbWFjcm8gYXZlcmFnZSBtZXRob2QgY2FsY3VsYXRlcyBhbmQgc3VtcyB0aGUgYWNjdXJhY3kgZm9yIGVhY2ggaW5kaXZpZHVhbCBsYWJlbCBhbmQgZGl2aWRlcyBmb3JcbiAgICAqIHRoZSBudW1iZXIgb2YgbGFiZWxzLlxuICAgICpcbiAgICAqIEByZXR1cm4gVGhlIG1hY3JvIGFjY3VyYWN5IHZhbHVlLlxuICAgICovXG4gICAgbWFjcm9BY2N1cmFjeSgpIHtcbiAgICAgICAgbGV0IHN1bSA9IDA7XG4gICAgICAgIHRoaXMubGFiZWxzLmZvckVhY2goKGxhYmVsKSA9PiBzdW0gKz0gdGhpcy5sYWJlbEFjY3VyYWN5KGxhYmVsKSk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1bSAvIHRoaXMubGFiZWxzLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdCB8fCAwO1xuICAgIH1cbiAgICAvKipcbiAgICAqIEdpdmVzIHRoZSBhY2N1cmFjeSB2YWx1ZSBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXgsIHRha2luZyBpbiBhY2NvdW50IHRoZSBhdmVyYWdlIHdlaWdodGVkIG1ldGhvZC5cbiAgICAqXG4gICAgKiBBY2N1cmFjeSBnaXZlcyB0aGUgZnJhY3Rpb24gb2YgdG90YWwgcHJlZGljdGlvbnMgd2hpY2ggd2VyZSBjb3JyZWN0bHkgY2xhc3NpZmllZC5cbiAgICAqXG4gICAgKiBUaGUgd2VpZ2h0ZWQgYXZlcmFnZSBtZXRob2QgZ2l2ZXMgdGhlIGxhYmVscyB3aXRoIG1vcmUgcHJlZGljdGlvbnMgbW9yZSBpbXBvcnRhbmNlICh3ZWlnaHQpXG4gICAgKiBpbiB0aGUgZmluYWwgYWNjdXJhY3kgdmFsdWUgY29tcGFyaW5nIHdpdGggbGFiZWxzIHdpdGggbGVzcyBwcmVkaWN0aW9ucy5cbiAgICAqXG4gICAgKiBAcmV0dXJuIFRoZSB3ZWlnaHRlZCBhY2N1cmFjeSB2YWx1ZS5cbiAgICAqL1xuICAgIHdlaWdodGVkQWNjdXJhY3koKSB7XG4gICAgICAgIGNvbnN0IHN1bUxhYmVscyA9IHRoaXMuZ2V0TGFiZWxzUHJlZGljdGlvbnNTdW0oKTtcbiAgICAgICAgY29uc3QgbnVtYmVyT2ZQcmVkaWN0aW9ucyA9IHRoaXMuZ2V0TnVtYmVyT2ZQcmVkaWN0aW9ucygpO1xuICAgICAgICBsZXQgc3VtID0gMDtcbiAgICAgICAgdGhpcy5sYWJlbHMuZm9yRWFjaCgobGFiZWwsIGluZGV4KSA9PiBzdW0gKz0gKHRoaXMubGFiZWxBY2N1cmFjeShsYWJlbCkgKiBzdW1MYWJlbHNbaW5kZXhdKSk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1bSAvIG51bWJlck9mUHJlZGljdGlvbnM7XG4gICAgICAgIHJldHVybiByZXN1bHQgfHwgMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTWlzY2xhc3NpZmljYXRpb24gcmF0ZSwgYWxzbyBrbm93IGFzIGNsYXNzaWZpY2F0aW9uIGVycm9yIGFuZCAxLUFjY3VyYWN5LFxuICAgICAqIGNhbGN1bGF0ZXMgdGhlIGZhY3Rpb24gb2YgcHJlZGljdGlvbnMgd2VyZSBpbmNvcnJlY3QuXG4gICAgICpcbiAgICAgKiBGb3JtdWxhOlxuICAgICAqXG4gICAgICogYWNjdXJhY3kgPSAoRlAgKyBGTikgLyAoVFAgKyBUTiArIEZQICsgRk4pXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29uZmlndXJhdGlvbiBTZXQgb2YgY29uZmlndXJhdGlvbnMgdXNlZCBvbiBtaXNzIGNsYXNzaWZpY2F0aW9uIHJhdGUgY2FsY3VsYXRpb25zLlxuICAgICAqXG4gICAgICogW1tjb25maWd1cmF0aW9uLmxhYmVsXV0gOiBUaGUgbGFiZWwgbmFtZSB3aGljaCB3aWxsIGJlIHVzZWQgdG8gY2FsY3VsYXRlIHRoZSBtaXNzIGNsYXNzaWZpY2F0aW9uIHJhdGUuXG4gICAgICogSWYgdW5kZWZpbmVkIG9yIG51bGwsIHRoZSB2YWx1ZSB3aWxsIGJlIGNhbGN1bGF0ZWQgZm9yIGFsbCBjb25mdXNpb24gbWF0cml4LlxuICAgICAqXG4gICAgICogW1tjb25maWd1cmF0aW9uLmF2ZXJhZ2VdXTogRGVmaW5lcyB3aGljaCB0eXBlIG9mIGF2ZXJhZ2Ugc2hvdWxkIGJlIHVzZWQuIFRoaXMgYXZlcmFnZSB3aWxsIG9ubHkgYmUgdGFrZW4gaW4gYWNjb3VudC5cbiAgICAgKiBvbiBtYXRyaXggY2FsY3VsYXRpb25zICh3aGVuIGxhYmVsID0gbnVsbCB8fCB1bmRlZmluZWQpLlxuICAgICAqXG4gICAgICogW1tjb25maWd1cmF0aW9uLmF2ZXJhZ2UuTWljcm9dXTogQ2FsY3VsYXRlcyB0aGUgVFAsIFROLCBGUCBhbmQgRk4gZm9yIHRoZSBtYXRyaXggZ2xvYmFsbHkgYW5kIHRoZW4gYXBwbGllcyB0aGVcbiAgICAgKiBtaXNzIGNsYXNzaWZpY2F0aW9uIGZvcm11bGEuXG4gICAgICpcbiAgICAgKiBbW2NvbmZpZ3VyYXRpb24uYXZlcmFnZS5NYWNyb11dOiBDYWxjdWxhdGVzIGFuZCBzdW1zIHRoZSBtaXNzIGNsYXNzaWZpY2F0aW9uIHJhdGUgZm9yIGVhY2ggaW5kaXZpZHVhbCBsYWJlbCBhbmQgZGl2aWRlcyBmb3JcbiAgICAgKiB0aGUgbnVtYmVyIG9mIGxhYmVscy5cbiAgICAgKlxuICAgICAqIFtbY29uZmlndXJhdGlvbi5hdmVyYWdlLldlaWdodGVkXV06IERlZmluZXMgaWYgdGhlIG1pc3MgY2xhc3NpZmljYXRpb24gY2FsY3VsYXRpb25zIHNob3VsZCBiZSB3ZWlnaHRlZC4gVGhpcyBtZWFucyB0aGUgbGFiZWxzXG4gICAgICogd2l0aCBtb3JlIHByZWRpY3Rpb25zIHdpbGwgd2VpZ2h0IG1vcmUgaW4gdGhlIGZpbmFsIHJhdGUgdmFsdWUgY29tcGFyaW5nIHdpdGggbGFiZWxzIHdpdGggbGVzcyBwcmVkaWN0aW9ucy5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gVGhlIG1pc3MgY2xhc3NpZmljYXRpb24gcmF0ZSB2YWx1ZS5cbiAgICAgKi9cbiAgICBtaXNzQ2xhc3NpZmljYXRpb25SYXRlKGNvbmZpZ3VyYXRpb24gPSB7IGF2ZXJhZ2U6IEF2ZXJhZ2VNZXRob2QuV2VpZ2h0ZWQgfSkge1xuICAgICAgICB0aGlzLnZhbGlkYXRlKCk7XG4gICAgICAgIGlmICgoY29uZmlndXJhdGlvbiA9PT0gbnVsbCB8fCBjb25maWd1cmF0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25maWd1cmF0aW9uLmxhYmVsKSAmJiAoY29uZmlndXJhdGlvbiA9PT0gbnVsbCB8fCBjb25maWd1cmF0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25maWd1cmF0aW9uLmxhYmVsLmxlbmd0aCkgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sYWJlbE1pc3NDbGFzc2lmaWNhdGlvblJhdGUoY29uZmlndXJhdGlvbi5sYWJlbCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4TWlzc0NsYXNzaWZpY2F0aW9uUmF0ZShjb25maWd1cmF0aW9uID09PSBudWxsIHx8IGNvbmZpZ3VyYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbmZpZ3VyYXRpb24uYXZlcmFnZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdpdmVzIHRoZSBtaXNzIGNsYXNzaWZpY2F0aW9uIHJhdGUgZm9yIGEgZ2l2ZW4gbWF0cml4IGxhYmVsLlxuICAgICAqXG4gICAgICogTWlzY2xhc3NpZmljYXRpb24gcmF0ZSwgYWxzbyBrbm93IGFzIGNsYXNzaWZpY2F0aW9uIGVycm9yIGFuZCAxLUFjY3VyYWN5LFxuICAgICAqIGNhbGN1bGF0ZXMgdGhlIGZhY3Rpb24gb2YgcHJlZGljdGlvbnMgd2VyZSBpbmNvcnJlY3QuXG4gICAgICpcbiAgICAgKiBGb3JtdWxhOlxuICAgICAqXG4gICAgICogbWlzc0NsYXNzaWZpY2F0aW9uID0gKEZQICsgRk4pIC8gKFRQICsgVE4gKyBGUCArIEZOKVxuICAgICAqXG4gICAgICogQHBhcmFtIGxhYmVsIFRoZSBsYWJlbCB1c2VkIHRvIGdldCB0aGUgbWlzcyBjbGFzc2lmaWNhdGlvbiByYXRlIHZhbHVlLlxuICAgICAqIEByZXR1cm4gTWlzcyBjbGFzc2lmaWNhdGlvbiByYXRlIGZvciBhIGdpdmVuIGxhYmVsLlxuICAgICAqL1xuICAgIGxhYmVsTWlzc0NsYXNzaWZpY2F0aW9uUmF0ZShsYWJlbCkge1xuICAgICAgICB0aGlzLnZhbGlkYXRlKCk7XG4gICAgICAgIGNvbnN0IHsgdHJ1ZVBvc2l0aXZlLCB0cnVlTmVnYXRpdmUsIGZhbHNlUG9zaXRpdmUsIGZhbHNlTmVnYXRpdmUgfSA9IHRoaXMuZ2V0Q29uZnVzaW9uTWF0cml4Q2xhc3NlcyhsYWJlbCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IChmYWxzZVBvc2l0aXZlICsgZmFsc2VOZWdhdGl2ZSkgLyAodHJ1ZVBvc2l0aXZlICsgdHJ1ZU5lZ2F0aXZlICsgZmFsc2VQb3NpdGl2ZSArIGZhbHNlTmVnYXRpdmUpO1xuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdpdmVzIHRoZSBtaXNzIGNsYXNzaWZpY2F0aW9uIHJhdGUgdmFsdWUgZm9yIGFsbCBjb25mdXNpb24gbWF0cml4LFxuICAgICAqIHRha2luZyBpbiBhY2NvdW50IGEgZ2l2ZW4gYXZlcmFnZSBtZXRob2Qgb2YgY2FsY3VsYXRpb24uXG4gICAgICpcbiAgICAgKiBNaXNjbGFzc2lmaWNhdGlvbiByYXRlLCBhbHNvIGtub3cgYXMgY2xhc3NpZmljYXRpb24gZXJyb3IgYW5kIDEtQWNjdXJhY3ksXG4gICAgICogY2FsY3VsYXRlcyB0aGUgZmFjdGlvbiBvZiBwcmVkaWN0aW9ucyB3ZXJlIGluY29ycmVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBhdmVyYWdlIERlZmluZXMgd2hpY2ggdHlwZSBvZiBhdmVyYWdlIHNob3VsZCBiZSB1c2VkLiBUaGlzIGF2ZXJhZ2Ugd2lsbCBvbmx5IGJlIHRha2VuIGluIGFjY291bnQuXG4gICAgICogb24gbWF0cml4IGNhbGN1bGF0aW9ucyAod2hlbiBsYWJlbCA9IG51bGwgfHwgdW5kZWZpbmVkKS5cbiAgICAgKlxuICAgICAqIFtbYXZlcmFnZS5NaWNyb11dOiBDYWxjdWxhdGVzIHRoZSBUUCwgVE4sIEZQIGFuZCBGTiBmb3IgdGhlIG1hdHJpeCBnbG9iYWxseSBhbmQgdGhlbiBhcHBsaWVzIHRoZVxuICAgICAqIG1pc3MgY2xhc3NpZmljYXRpb24gZm9ybXVsYS5cbiAgICAgKlxuICAgICAqIFtbYXZlcmFnZS5NYWNyb11dOiBDYWxjdWxhdGVzIGFuZCBzdW1zIHRoZSBtaXNzIGNsYXNzaWZpY2F0aW9uIGZvciBlYWNoIGluZGl2aWR1YWwgbGFiZWwgYW5kIGRpdmlkZXMgZm9yXG4gICAgICogdGhlIG51bWJlciBvZiBsYWJlbHMuXG4gICAgICpcbiAgICAgKiBbW2F2ZXJhZ2UuV2VpZ2h0ZWRdXTogRGVmaW5lcyBpZiB0aGUgbWlzcyBjbGFzc2lmaWNhdGlvbiBjYWxjdWxhdGlvbnMgc2hvdWxkIGJlIHdlaWdodGVkLiBUaGlzIG1lYW5zIHRoZSBsYWJlbHNcbiAgICAgKiB3aXRoIG1vcmUgcHJlZGljdGlvbnMgd2lsbCB3ZWlnaHQgbW9yZSBpbiB0aGUgZmluYWwgbWlzcyBjbGFzc2lmaWNhdGlvbiB2YWx1ZSBjb21wYXJpbmcgd2l0aCBsYWJlbHMgd2l0aCBsZXNzLlxuICAgICAqIHByZWRpY3Rpb25zLlxuICAgICAqXG4gICAgICogQHJldHVybiBUaGUgbWlzcyBjbGFzc2lmaWNhdGlvbiB2YWx1ZS5cbiAgICAgKi9cbiAgICBtYXRyaXhNaXNzQ2xhc3NpZmljYXRpb25SYXRlKGF2ZXJhZ2UgPSBBdmVyYWdlTWV0aG9kLldlaWdodGVkKSB7XG4gICAgICAgIHRoaXMudmFsaWRhdGUoKTtcbiAgICAgICAgc3dpdGNoIChhdmVyYWdlKSB7XG4gICAgICAgICAgICBjYXNlIEF2ZXJhZ2VNZXRob2QuTWljcm86IHJldHVybiB0aGlzLm1pY3JvTWlzc0NsYXNzaWZpY2F0aW9uUmF0ZSgpO1xuICAgICAgICAgICAgY2FzZSBBdmVyYWdlTWV0aG9kLk1hY3JvOiByZXR1cm4gdGhpcy5tYWNyb01pc3NDbGFzc2lmaWNhdGlvblJhdGUoKTtcbiAgICAgICAgICAgIGNhc2UgQXZlcmFnZU1ldGhvZC5XZWlnaHRlZDogcmV0dXJuIHRoaXMud2VpZ2h0ZWRNaXNzQ2xhc3NpZmljYXRpb25SYXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgKiBHaXZlcyB0aGUgbWlzcyBjbGFzc2lmaWNhdGlvbiB2YWx1ZSBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXgsIHRha2luZyBpbiBhY2NvdW50IHRoZSBtaWNybyBhdmVyYWdlIG1ldGhvZC5cbiAgICAqXG4gICAgKiBNaXNjbGFzc2lmaWNhdGlvbiByYXRlLCBhbHNvIGtub3cgYXMgY2xhc3NpZmljYXRpb24gZXJyb3IgYW5kIDEtQWNjdXJhY3ksXG4gICAgKiBjYWxjdWxhdGVzIHRoZSBmYWN0aW9uIG9mIHByZWRpY3Rpb25zIHdlcmUgaW5jb3JyZWN0LlxuICAgICpcbiAgICAqIFRoZSBtaWNybyBhdmVyYWdlIG1ldGhvZCBjYWxjdWxhdGVzIGFuZCBzdW1zIHRoZSBtaXNzIGNsYXNzaWZpY2F0aW9uIGZvciBlYWNoIGluZGl2aWR1YWwgbGFiZWwgYW5kIGRpdmlkZXMgZm9yXG4gICAgKiB0aGUgbnVtYmVyIG9mIGxhYmVscy5cbiAgICAqXG4gICAgKiBAcmV0dXJuIFRoZSBtaWNybyBtaXNzIGNsYXNzaWZpY2F0aW9uIHZhbHVlLlxuICAgICovXG4gICAgbWljcm9NaXNzQ2xhc3NpZmljYXRpb25SYXRlKCkge1xuICAgICAgICBjb25zdCB7IHRydWVQb3NpdGl2ZSwgdHJ1ZU5lZ2F0aXZlLCBmYWxzZVBvc2l0aXZlLCBmYWxzZU5lZ2F0aXZlIH0gPSB0aGlzLmdldFN1bUNvbmZ1c2lvbk1hdHJpeENsYXNzZXMoKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gKGZhbHNlUG9zaXRpdmUgKyBmYWxzZU5lZ2F0aXZlKSAvICh0cnVlUG9zaXRpdmUgKyB0cnVlTmVnYXRpdmUgKyBmYWxzZVBvc2l0aXZlICsgZmFsc2VOZWdhdGl2ZSk7XG4gICAgICAgIHJldHVybiByZXN1bHQgfHwgMDtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBHaXZlcyB0aGUgbWlzcyBjbGFzc2lmaWNhdGlvbiB2YWx1ZSBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXgsIHRha2luZyBpbiBhY2NvdW50IHRoZSBtYWNybyBhdmVyYWdlIG1ldGhvZC5cbiAgICAqXG4gICAgKiBNaXNjbGFzc2lmaWNhdGlvbiByYXRlLCBhbHNvIGtub3cgYXMgY2xhc3NpZmljYXRpb24gZXJyb3IgYW5kIDEtQWNjdXJhY3ksXG4gICAgKiBjYWxjdWxhdGVzIHRoZSBmYWN0aW9uIG9mIHByZWRpY3Rpb25zIHdlcmUgaW5jb3JyZWN0LlxuICAgICpcbiAgICAqIFRoZSBtYWNybyBhdmVyYWdlIG1ldGhvZCBjYWxjdWxhdGVzIGFuZCBzdW1zIHRoZSBtaXNzIGNsYXNzaWZpY2F0aW9uIGZvciBlYWNoIGluZGl2aWR1YWwgbGFiZWwgYW5kIGRpdmlkZXMgZm9yXG4gICAgKiB0aGUgbnVtYmVyIG9mIGxhYmVscy5cbiAgICAqXG4gICAgKiBAcmV0dXJuIFRoZSBtYWNybyBtaXNzIGNsYXNzaWZpY2F0aW9uIHZhbHVlLlxuICAgICovXG4gICAgbWFjcm9NaXNzQ2xhc3NpZmljYXRpb25SYXRlKCkge1xuICAgICAgICBsZXQgc3VtID0gMDtcbiAgICAgICAgdGhpcy5sYWJlbHMuZm9yRWFjaCgobGFiZWwpID0+IHN1bSArPSB0aGlzLmxhYmVsTWlzc0NsYXNzaWZpY2F0aW9uUmF0ZShsYWJlbCkpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBzdW0gLyB0aGlzLmxhYmVscy5sZW5ndGg7XG4gICAgICAgIHJldHVybiByZXN1bHQgfHwgMDtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBHaXZlcyB0aGUgbWlzcyBjbGFzc2lmaWNhdGlvbiB2YWx1ZSBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXgsIHRha2luZyBpbiBhY2NvdW50IHRoZSBhdmVyYWdlIHdlaWdodGVkIG1ldGhvZC5cbiAgICAqXG4gICAgKiBNaXNjbGFzc2lmaWNhdGlvbiByYXRlLCBhbHNvIGtub3cgYXMgY2xhc3NpZmljYXRpb24gZXJyb3IgYW5kIDEtQWNjdXJhY3ksXG4gICAgKiBjYWxjdWxhdGVzIHRoZSBmYWN0aW9uIG9mIHByZWRpY3Rpb25zIHdlcmUgaW5jb3JyZWN0LlxuICAgICpcbiAgICAqIFRoZSB3ZWlnaHRlZCBhdmVyYWdlIG1ldGhvZCBnaXZlcyB0aGUgbGFiZWxzIHdpdGggbW9yZSBwcmVkaWN0aW9ucyBtb3JlIGltcG9ydGFuY2UgKHdlaWdodClcbiAgICAqIGluIHRoZSBmaW5hbCBtaXNzIGNsYXNzaWZpY2F0aW9uIHZhbHVlIGNvbXBhcmluZyB3aXRoIGxhYmVscyB3aXRoIGxlc3MgcHJlZGljdGlvbnMuXG4gICAgKlxuICAgICogQHJldHVybiBUaGUgd2VpZ2h0ZWQgbWlzcyBjbGFzc2lmaWNhdGlvbiB2YWx1ZS5cbiAgICAqL1xuICAgIHdlaWdodGVkTWlzc0NsYXNzaWZpY2F0aW9uUmF0ZSgpIHtcbiAgICAgICAgY29uc3Qgc3VtTGFiZWxzID0gdGhpcy5nZXRMYWJlbHNQcmVkaWN0aW9uc1N1bSgpO1xuICAgICAgICBjb25zdCBudW1iZXJPZlByZWRpY3Rpb25zID0gdGhpcy5nZXROdW1iZXJPZlByZWRpY3Rpb25zKCk7XG4gICAgICAgIGxldCBzdW0gPSAwO1xuICAgICAgICB0aGlzLmxhYmVscy5mb3JFYWNoKChsYWJlbCwgaW5kZXgpID0+IHN1bSArPSAodGhpcy5sYWJlbE1pc3NDbGFzc2lmaWNhdGlvblJhdGUobGFiZWwpICogc3VtTGFiZWxzW2luZGV4XSkpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBzdW0gLyBudW1iZXJPZlByZWRpY3Rpb25zO1xuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByZWNpc2lvbiwgZ2l2ZXMgd2hhdCBmcmFjdGlvbiBvZiBwcmVkaWN0aW9ucyBhcyBhIHBvc2l0aXZlIGNsYXNzIHdlcmUgYWN0dWFsIHBvc2l0aXZlLlxuICAgICAqXG4gICAgICogRm9ybXVsYTpcbiAgICAgKlxuICAgICAqIHByZWNpc2lvbiA9IChUUCkgLyAoVFAgKyBGUClcbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb25maWd1cmF0aW9uIFNldCBvZiBjb25maWd1cmF0aW9ucyB1c2VkIG9uIHByZWNpc2lvbiBjYWxjdWxhdGlvbnMuXG4gICAgICpcbiAgICAgKiBbW2NvbmZpZ3VyYXRpb24ubGFiZWxdXSA6IFRoZSBsYWJlbCBuYW1lIHdoaWNoIHdpbGwgYmUgdXNlZCB0byBjYWxjdWxhdGUgdGhlIHByZWNpc2lvbiB2YWx1ZS5cbiAgICAgKiBJZiB1bmRlZmluZWQgb3IgbnVsbCwgdGhlIHZhbHVlIHdpbGwgYmUgY2FsY3VsYXRlZCBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXguXG4gICAgICpcbiAgICAgKiBbW2NvbmZpZ3VyYXRpb24uYXZlcmFnZV1dOiBEZWZpbmVzIHdoaWNoIHR5cGUgb2YgYXZlcmFnZSBzaG91bGQgYmUgdXNlZC4gVGhpcyBhdmVyYWdlIHdpbGwgb25seSBiZSB0YWtlbiBpbiBhY2NvdW50LlxuICAgICAqIG9uIG1hdHJpeCBjYWxjdWxhdGlvbnMgKHdoZW4gbGFiZWwgPSBudWxsIHx8IHVuZGVmaW5lZCkuXG4gICAgICpcbiAgICAgKiBbW2NvbmZpZ3VyYXRpb24uYXZlcmFnZS5NaWNyb11dOiBDYWxjdWxhdGVzIHRoZSBUUCwgVE4sIEZQIGFuZCBGTiBmb3IgdGhlIG1hdHJpeCBnbG9iYWxseSBhbmQgdGhlbiBhcHBsaWVzIHRoZVxuICAgICAqIHByZWNpc2lvbiBmb3JtdWxhLlxuICAgICAqXG4gICAgICogW1tjb25maWd1cmF0aW9uLmF2ZXJhZ2UuTWFjcm9dXTogQ2FsY3VsYXRlcyBhbmQgc3VtcyB0aGUgbWlzcyBjbGFzc2lmaWNhdGlvbiByYXRlIGZvciBlYWNoIGluZGl2aWR1YWwgbGFiZWwgYW5kIGRpdmlkZXMgZm9yXG4gICAgICogdGhlIG51bWJlciBvZiBsYWJlbHMuXG4gICAgICpcbiAgICAgKiBbW2NvbmZpZ3VyYXRpb24uYXZlcmFnZS5XZWlnaHRlZF1dOiBEZWZpbmVzIGlmIHRoZSBwcmVjaXNpb24gY2FsY3VsYXRpb25zIHNob3VsZCBiZSB3ZWlnaHRlZC4gVGhpcyBtZWFucyB0aGUgbGFiZWxzXG4gICAgICogd2l0aCBtb3JlIHByZWRpY3Rpb25zIHdpbGwgd2VpZ2h0IG1vcmUgaW4gdGhlIGZpbmFsIHZhbHVlIGNvbXBhcmluZyB3aXRoIGxhYmVscyB3aXRoIGxlc3MgcHJlZGljdGlvbnMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFRoZSBwcmVjaXNpb24gdmFsdWUuXG4gICAgICovXG4gICAgcHJlY2lzaW9uKGNvbmZpZ3VyYXRpb24gPSB7IGF2ZXJhZ2U6IEF2ZXJhZ2VNZXRob2QuV2VpZ2h0ZWQgfSkge1xuICAgICAgICB0aGlzLnZhbGlkYXRlKCk7XG4gICAgICAgIGlmICgoY29uZmlndXJhdGlvbiA9PT0gbnVsbCB8fCBjb25maWd1cmF0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25maWd1cmF0aW9uLmxhYmVsKSAmJiAoY29uZmlndXJhdGlvbiA9PT0gbnVsbCB8fCBjb25maWd1cmF0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25maWd1cmF0aW9uLmxhYmVsLmxlbmd0aCkgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sYWJlbFByZWNpc2lvbihjb25maWd1cmF0aW9uLmxhYmVsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXhQcmVjaXNpb24oY29uZmlndXJhdGlvbiA9PT0gbnVsbCB8fCBjb25maWd1cmF0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25maWd1cmF0aW9uLmF2ZXJhZ2UpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHaXZlcyB0aGUgcHJlY2lzaW9uIHZhbHVlIGZvciBhIGdpdmVuIG1hdHJpeCBsYWJlbC5cbiAgICAgKlxuICAgICAqIFByZWNpc2lvbiwgc3RhbmRzIGZvciB3aGF0IGZyYWN0aW9uIG9mIHByZWRpY3Rpb25zIGFzIGEgcG9zaXRpdmUgY2xhc3Mgd2VyZSBhY3R1YWwgcG9zaXRpdmUuXG4gICAgICpcbiAgICAgKiBGb3JtdWxhOlxuICAgICAqXG4gICAgICogcHJlY2lzaW9uID0gKFRQKSAvIChUUCArIEZQKVxuICAgICAqXG4gICAgICogQHBhcmFtIGxhYmVsIFRoZSBsYWJlbCB1c2VkIHRvIGdldCB0aGUgcHJlY2lzaW9uIHZhbHVlLlxuICAgICAqIEByZXR1cm4gUHJlY2lzaW9uIHZhbHVlIGZvciBhIGdpdmVuIGxhYmVsLlxuICAgICAqL1xuICAgIGxhYmVsUHJlY2lzaW9uKGxhYmVsKSB7XG4gICAgICAgIHRoaXMudmFsaWRhdGUoKTtcbiAgICAgICAgY29uc3QgeyB0cnVlUG9zaXRpdmUsIGZhbHNlUG9zaXRpdmUgfSA9IHRoaXMuZ2V0Q29uZnVzaW9uTWF0cml4Q2xhc3NlcyhsYWJlbCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9ICgodHJ1ZVBvc2l0aXZlKSAvICh0cnVlUG9zaXRpdmUgKyBmYWxzZVBvc2l0aXZlKSk7XG4gICAgICAgIHJldHVybiByZXN1bHQgfHwgMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2l2ZXMgdGhlIHByZWNpc2lvbiB2YWx1ZSBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXgsXG4gICAgICogdGFraW5nIGluIGFjY291bnQgYSBnaXZlbiBhdmVyYWdlIG1ldGhvZCBvZiBjYWxjdWxhdGlvbi5cbiAgICAgKlxuICAgICAqIFByZWNpc2lvbiwgc3RhbmRzIGZvciB3aGF0IGZyYWN0aW9uIG9mIHByZWRpY3Rpb25zIGFzIGEgcG9zaXRpdmUgY2xhc3Mgd2VyZSBhY3R1YWwgcG9zaXRpdmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYXZlcmFnZSBEZWZpbmVzIHdoaWNoIHR5cGUgb2YgYXZlcmFnZSBzaG91bGQgYmUgdXNlZC4gVGhpcyBhdmVyYWdlIHdpbGwgb25seSBiZSB0YWtlbiBpbiBhY2NvdW50LlxuICAgICAqIG9uIG1hdHJpeCBjYWxjdWxhdGlvbnMgKHdoZW4gbGFiZWwgPSBudWxsIHx8IHVuZGVmaW5lZCkuXG4gICAgICpcbiAgICAgKiBbW2F2ZXJhZ2UuTWljcm9dXTogQ2FsY3VsYXRlcyB0aGUgVFAsIFROLCBGUCBhbmQgRk4gZm9yIHRoZSBtYXRyaXggZ2xvYmFsbHkgYW5kIHRoZW4gYXBwbGllcyB0aGVcbiAgICAgKiBwcmVjaXNpb24gZm9ybXVsYS5cbiAgICAgKlxuICAgICAqIFtbYXZlcmFnZS5NYWNyb11dOiBDYWxjdWxhdGVzIGFuZCBzdW1zIHRoZSBwcmVjaXNpb24gZm9yIGVhY2ggaW5kaXZpZHVhbCBsYWJlbCBhbmQgZGl2aWRlcyBmb3JcbiAgICAgKiB0aGUgbnVtYmVyIG9mIGxhYmVscy5cbiAgICAgKlxuICAgICAqIFtbYXZlcmFnZS5XZWlnaHRlZF1dOiBEZWZpbmVzIGlmIHRoZSBwcmVjaXNpb24gY2FsY3VsYXRpb25zIHNob3VsZCBiZSB3ZWlnaHRlZC4gVGhpcyBtZWFucyB0aGUgbGFiZWxzXG4gICAgICogd2l0aCBtb3JlIHByZWRpY3Rpb25zIHdpbGwgd2VpZ2h0IG1vcmUgaW4gdGhlIGZpbmFsIHByZWNpc2lvbiB2YWx1ZSBjb21wYXJpbmcgd2l0aCBsYWJlbHMgd2l0aCBsZXNzLlxuICAgICAqIHByZWRpY3Rpb25zLlxuICAgICAqXG4gICAgICogQHJldHVybiBUaGUgcHJlY2lzaW9uIHZhbHVlLlxuICAgICAqL1xuICAgIG1hdHJpeFByZWNpc2lvbihhdmVyYWdlID0gQXZlcmFnZU1ldGhvZC5XZWlnaHRlZCkge1xuICAgICAgICB0aGlzLnZhbGlkYXRlKCk7XG4gICAgICAgIHN3aXRjaCAoYXZlcmFnZSkge1xuICAgICAgICAgICAgY2FzZSBBdmVyYWdlTWV0aG9kLk1pY3JvOiByZXR1cm4gdGhpcy5taWNyb1ByZWNpc2lvbigpO1xuICAgICAgICAgICAgY2FzZSBBdmVyYWdlTWV0aG9kLk1hY3JvOiByZXR1cm4gdGhpcy5tYWNyb1ByZWNpc2lvbigpO1xuICAgICAgICAgICAgY2FzZSBBdmVyYWdlTWV0aG9kLldlaWdodGVkOiByZXR1cm4gdGhpcy53ZWlnaHRlZFByZWNpc2lvbigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICogR2l2ZXMgdGhlIHByZWNpc2lvbiB2YWx1ZSBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXgsIHRha2luZyBpbiBhY2NvdW50IHRoZSBtaWNybyBhdmVyYWdlIG1ldGhvZC5cbiAgICAqXG4gICAgKiBQcmVjaXNpb24sIGdpdmVzIHdoYXQgZnJhY3Rpb24gb2YgcHJlZGljdGlvbnMgYXMgYSBwb3NpdGl2ZSBjbGFzcyB3ZXJlIGFjdHVhbCBwb3NpdGl2ZS5cbiAgICAqXG4gICAgKiBUaGUgbWljcm8gYXZlcmFnZSBtZXRob2QgY2FsY3VsYXRlcyBhbmQgc3VtcyB0aGUgcHJlY2lzaW9uIGZvciBlYWNoIGluZGl2aWR1YWwgbGFiZWwgYW5kIGRpdmlkZXMgZm9yXG4gICAgKiB0aGUgbnVtYmVyIG9mIGxhYmVscy5cbiAgICAqXG4gICAgKiBAcmV0dXJuIFRoZSBtaWNybyBwcmVjaXNpb24gdmFsdWUuXG4gICAgKi9cbiAgICBtaWNyb1ByZWNpc2lvbigpIHtcbiAgICAgICAgY29uc3QgeyB0cnVlUG9zaXRpdmUsIGZhbHNlUG9zaXRpdmUgfSA9IHRoaXMuZ2V0U3VtQ29uZnVzaW9uTWF0cml4Q2xhc3NlcygpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSAoKHRydWVQb3NpdGl2ZSkgLyAodHJ1ZVBvc2l0aXZlICsgZmFsc2VQb3NpdGl2ZSkpO1xuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICogR2l2ZXMgdGhlIHByZWNpc2lvbiB2YWx1ZSBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXgsIHRha2luZyBpbiBhY2NvdW50IHRoZSBtYWNybyBhdmVyYWdlIG1ldGhvZC5cbiAgICAqXG4gICAgKiBQcmVjaXNpb24sIGdpdmVzIHdoYXQgZnJhY3Rpb24gb2YgcHJlZGljdGlvbnMgYXMgYSBwb3NpdGl2ZSBjbGFzcyB3ZXJlIGFjdHVhbCBwb3NpdGl2ZS5cbiAgICAqXG4gICAgKiBUaGUgbWFjcm8gYXZlcmFnZSBtZXRob2QgY2FsY3VsYXRlcyBhbmQgc3VtcyB0aGUgcHJlY2lzaW9uIGZvciBlYWNoIGluZGl2aWR1YWwgbGFiZWwgYW5kIGRpdmlkZXMgZm9yXG4gICAgKiB0aGUgbnVtYmVyIG9mIGxhYmVscy5cbiAgICAqXG4gICAgKiBAcmV0dXJuIFRoZSBtYWNybyBwcmVjaXNpb24gdmFsdWUuXG4gICAgKi9cbiAgICBtYWNyb1ByZWNpc2lvbigpIHtcbiAgICAgICAgbGV0IHN1bSA9IDA7XG4gICAgICAgIHRoaXMubGFiZWxzLmZvckVhY2goKGxhYmVsKSA9PiBzdW0gKz0gdGhpcy5sYWJlbFByZWNpc2lvbihsYWJlbCkpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBzdW0gLyB0aGlzLmxhYmVscy5sZW5ndGg7XG4gICAgICAgIHJldHVybiByZXN1bHQgfHwgMDtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBHaXZlcyB0aGUgcHJlY2lzaW9uIHZhbHVlIGZvciBhbGwgY29uZnVzaW9uIG1hdHJpeCwgdGFraW5nIGluIGFjY291bnQgdGhlIGF2ZXJhZ2Ugd2VpZ2h0ZWQgbWV0aG9kLlxuICAgICpcbiAgICAqIFByZWNpc2lvbiwgZ2l2ZXMgd2hhdCBmcmFjdGlvbiBvZiBwcmVkaWN0aW9ucyBhcyBhIHBvc2l0aXZlIGNsYXNzIHdlcmUgYWN0dWFsIHBvc2l0aXZlLlxuICAgICpcbiAgICAqIFRoZSB3ZWlnaHRlZCBhdmVyYWdlIG1ldGhvZCBnaXZlcyB0aGUgbGFiZWxzIHdpdGggbW9yZSBwcmVkaWN0aW9ucyBtb3JlIGltcG9ydGFuY2UgKHdlaWdodClcbiAgICAqIGluIHRoZSBmaW5hbCBwcmVjaXNpb24gdmFsdWUgY29tcGFyaW5nIHdpdGggbGFiZWxzIHdpdGggbGVzcyBwcmVkaWN0aW9ucy5cbiAgICAqXG4gICAgKiBAcmV0dXJuIFRoZSB3ZWlnaHRlZCBwcmVjaXNpb24gdmFsdWUuXG4gICAgKi9cbiAgICB3ZWlnaHRlZFByZWNpc2lvbigpIHtcbiAgICAgICAgY29uc3Qgc3VtTGFiZWxzID0gdGhpcy5nZXRMYWJlbHNQcmVkaWN0aW9uc1N1bSgpO1xuICAgICAgICBjb25zdCBudW1iZXJPZlByZWRpY3Rpb25zID0gdGhpcy5nZXROdW1iZXJPZlByZWRpY3Rpb25zKCk7XG4gICAgICAgIGxldCBzdW0gPSAwO1xuICAgICAgICB0aGlzLmxhYmVscy5mb3JFYWNoKChsYWJlbCwgaW5kZXgpID0+IHN1bSArPSAodGhpcy5sYWJlbFByZWNpc2lvbihsYWJlbCkgKiBzdW1MYWJlbHNbaW5kZXhdKSk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1bSAvIG51bWJlck9mUHJlZGljdGlvbnM7XG4gICAgICAgIHJldHVybiByZXN1bHQgfHwgMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVjYWxsLCBhbHNvIGtub3cgYXMgdHJ1ZSBwb3NpdGl2ZSByYXRlLCBzZW5zaXRpdml0eSwgaGl0IHJhdGUgYW5kIHByb2JhYmlsaXR5IG9mIGRldGVjdGlvbixcbiAgICAgKiBnaXZlcyB3aGF0IGZyYWN0aW9uIG9mIGFsbCBwb3NpdGl2ZXMgY2xhc3NlcyBjb3JyZWN0bHkgcHJlZGljdGVkIGFzIHBvc2l0aXZlLlxuICAgICAqXG4gICAgICogRm9ybXVsYTpcbiAgICAgKlxuICAgICAqIHJlY2FsbCA9IFRQIC8gKFRQICsgRk4pXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29uZmlndXJhdGlvbiBTZXQgb2YgY29uZmlndXJhdGlvbnMgdXNlZCBvbiByZWNhbGwgY2FsY3VsYXRpb25zLlxuICAgICAqXG4gICAgICogW1tjb25maWd1cmF0aW9uLmxhYmVsXV0gOiBUaGUgbGFiZWwgbmFtZSB3aGljaCB3aWxsIGJlIHVzZWQgdG8gY2FsY3VsYXRlIHRoZSByZWNhbGwgdmFsdWUuXG4gICAgICogSWYgdW5kZWZpbmVkIG9yIG51bGwsIHRoZSB2YWx1ZSB3aWxsIGJlIGNhbGN1bGF0ZWQgZm9yIGFsbCBjb25mdXNpb24gbWF0cml4LlxuICAgICAqXG4gICAgICogW1tjb25maWd1cmF0aW9uLmF2ZXJhZ2VdXTogRGVmaW5lcyB3aGljaCB0eXBlIG9mIGF2ZXJhZ2Ugc2hvdWxkIGJlIHVzZWQuIFRoaXMgYXZlcmFnZSB3aWxsIG9ubHkgYmUgdGFrZW4gaW4gYWNjb3VudC5cbiAgICAgKiBvbiBtYXRyaXggY2FsY3VsYXRpb25zICh3aGVuIGxhYmVsID0gbnVsbCB8fCB1bmRlZmluZWQpLlxuICAgICAqXG4gICAgICogW1tjb25maWd1cmF0aW9uLmF2ZXJhZ2UuTWljcm9dXTogQ2FsY3VsYXRlcyB0aGUgVFAsIFROLCBGUCBhbmQgRk4gZm9yIHRoZSBtYXRyaXggZ2xvYmFsbHkgYW5kIHRoZW4gYXBwbGllcyB0aGVcbiAgICAgKiByZWNhbGwgZm9ybXVsYS5cbiAgICAgKlxuICAgICAqIFtbY29uZmlndXJhdGlvbi5hdmVyYWdlLk1hY3JvXV06IENhbGN1bGF0ZXMgYW5kIHN1bXMgdGhlIG1pc3MgY2xhc3NpZmljYXRpb24gcmF0ZSBmb3IgZWFjaCBpbmRpdmlkdWFsIGxhYmVsIGFuZCBkaXZpZGVzIGZvclxuICAgICAqIHRoZSBudW1iZXIgb2YgbGFiZWxzLlxuICAgICAqXG4gICAgICogW1tjb25maWd1cmF0aW9uLmF2ZXJhZ2UuV2VpZ2h0ZWRdXTogRGVmaW5lcyBpZiB0aGUgcmVjYWxsIGNhbGN1bGF0aW9ucyBzaG91bGQgYmUgd2VpZ2h0ZWQuIFRoaXMgbWVhbnMgdGhlIGxhYmVsc1xuICAgICAqIHdpdGggbW9yZSBwcmVkaWN0aW9ucyB3aWxsIHdlaWdodCBtb3JlIGluIHRoZSBmaW5hbCB2YWx1ZSBjb21wYXJpbmcgd2l0aCBsYWJlbHMgd2l0aCBsZXNzIHByZWRpY3Rpb25zLlxuICAgICAqXG4gICAgICogQHJldHVybiBUaGUgcmVjYWxsIHZhbHVlLlxuICAgICAqL1xuICAgIHJlY2FsbChjb25maWd1cmF0aW9uID0geyBhdmVyYWdlOiBBdmVyYWdlTWV0aG9kLldlaWdodGVkIH0pIHtcbiAgICAgICAgdGhpcy52YWxpZGF0ZSgpO1xuICAgICAgICBpZiAoKGNvbmZpZ3VyYXRpb24gPT09IG51bGwgfHwgY29uZmlndXJhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29uZmlndXJhdGlvbi5sYWJlbCkgJiYgKGNvbmZpZ3VyYXRpb24gPT09IG51bGwgfHwgY29uZmlndXJhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29uZmlndXJhdGlvbi5sYWJlbC5sZW5ndGgpID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGFiZWxSZWNhbGwoY29uZmlndXJhdGlvbi5sYWJlbCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4UmVjYWxsKGNvbmZpZ3VyYXRpb24gPT09IG51bGwgfHwgY29uZmlndXJhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29uZmlndXJhdGlvbi5hdmVyYWdlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2l2ZXMgdGhlIHJlY2FsbCB2YWx1ZSBmb3IgYSBnaXZlbiBtYXRyaXggbGFiZWwuXG4gICAgICpcbiAgICAgKiBSZWNhbGwsIGFsc28ga25vdyBhcyB0cnVlIHBvc2l0aXZlIHJhdGUsIHNlbnNpdGl2aXR5LCBoaXQgcmF0ZSBhbmQgcHJvYmFiaWxpdHkgb2YgZGV0ZWN0aW9uLFxuICAgICAqIGdpdmVzIHdoYXQgZnJhY3Rpb24gb2YgYWxsIHBvc2l0aXZlcyBjbGFzc2VzIGNvcnJlY3RseSBwcmVkaWN0ZWQgYXMgcG9zaXRpdmUuXG4gICAgICpcbiAgICAgKiBGb3JtdWxhOlxuICAgICAqXG4gICAgICogcmVjYWxsID0gVFAgLyAoVFAgKyBGTilcbiAgICAgKlxuICAgICAqIEBwYXJhbSBsYWJlbCBUaGUgbGFiZWwgdXNlZCB0byBnZXQgdGhlIHJlY2FsbCB2YWx1ZS5cbiAgICAgKiBAcmV0dXJuIFJlY2FsbCB2YWx1ZSBmb3IgYSBnaXZlbiBsYWJlbC5cbiAgICAgKi9cbiAgICBsYWJlbFJlY2FsbChsYWJlbCkge1xuICAgICAgICB0aGlzLnZhbGlkYXRlKCk7XG4gICAgICAgIGNvbnN0IHsgdHJ1ZVBvc2l0aXZlLCBmYWxzZU5lZ2F0aXZlIH0gPSB0aGlzLmdldENvbmZ1c2lvbk1hdHJpeENsYXNzZXMobGFiZWwpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSAoKHRydWVQb3NpdGl2ZSkgLyAodHJ1ZVBvc2l0aXZlICsgZmFsc2VOZWdhdGl2ZSkpO1xuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdpdmVzIHRoZSByZWNhbGwgdmFsdWUgZm9yIGFsbCBjb25mdXNpb24gbWF0cml4LFxuICAgICAqIHRha2luZyBpbiBhY2NvdW50IGEgZ2l2ZW4gYXZlcmFnZSBtZXRob2Qgb2YgY2FsY3VsYXRpb24uXG4gICAgICpcbiAgICAgKiBSZWNhbGwsIGFsc28ga25vdyBhcyB0cnVlIHBvc2l0aXZlIHJhdGUsIHNlbnNpdGl2aXR5LCBoaXQgcmF0ZSBhbmQgcHJvYmFiaWxpdHkgb2YgZGV0ZWN0aW9uLFxuICAgICAqIGdpdmVzIHdoYXQgZnJhY3Rpb24gb2YgYWxsIHBvc2l0aXZlcyBjbGFzc2VzIGNvcnJlY3RseSBwcmVkaWN0ZWQgYXMgcG9zaXRpdmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYXZlcmFnZSBEZWZpbmVzIHdoaWNoIHR5cGUgb2YgYXZlcmFnZSBzaG91bGQgYmUgdXNlZC4gVGhpcyBhdmVyYWdlIHdpbGwgb25seSBiZSB0YWtlbiBpbiBhY2NvdW50LlxuICAgICAqIG9uIG1hdHJpeCBjYWxjdWxhdGlvbnMgKHdoZW4gbGFiZWwgPSBudWxsIHx8IHVuZGVmaW5lZCkuXG4gICAgICpcbiAgICAgKiBbW2F2ZXJhZ2UuTWljcm9dXTogQ2FsY3VsYXRlcyB0aGUgVFAsIFROLCBGUCBhbmQgRk4gZm9yIHRoZSBtYXRyaXggZ2xvYmFsbHkgYW5kIHRoZW4gYXBwbGllcyB0aGVcbiAgICAgKiByZWNhbGwgZm9ybXVsYS5cbiAgICAgKlxuICAgICAqIFtbYXZlcmFnZS5NYWNyb11dOiBDYWxjdWxhdGVzIGFuZCBzdW1zIHRoZSByZWNhbGwgZm9yIGVhY2ggaW5kaXZpZHVhbCBsYWJlbCBhbmQgZGl2aWRlcyBmb3JcbiAgICAgKiB0aGUgbnVtYmVyIG9mIGxhYmVscy5cbiAgICAgKlxuICAgICAqIFtbYXZlcmFnZS5XZWlnaHRlZF1dOiBEZWZpbmVzIGlmIHRoZSByZWNhbGwgY2FsY3VsYXRpb25zIHNob3VsZCBiZSB3ZWlnaHRlZC4gVGhpcyBtZWFucyB0aGUgbGFiZWxzXG4gICAgICogd2l0aCBtb3JlIHByZWRpY3Rpb25zIHdpbGwgd2VpZ2h0IG1vcmUgaW4gdGhlIGZpbmFsIHJlY2FsbCB2YWx1ZSBjb21wYXJpbmcgd2l0aCBsYWJlbHMgd2l0aCBsZXNzLlxuICAgICAqIHByZWRpY3Rpb25zLlxuICAgICAqXG4gICAgICogQHJldHVybiBUaGUgcmVjYWxsIHZhbHVlLlxuICAgICAqL1xuICAgIG1hdHJpeFJlY2FsbChhdmVyYWdlID0gQXZlcmFnZU1ldGhvZC5XZWlnaHRlZCkge1xuICAgICAgICB0aGlzLnZhbGlkYXRlKCk7XG4gICAgICAgIHN3aXRjaCAoYXZlcmFnZSkge1xuICAgICAgICAgICAgY2FzZSBBdmVyYWdlTWV0aG9kLk1pY3JvOiByZXR1cm4gdGhpcy5taWNyb1JlY2FsbCgpO1xuICAgICAgICAgICAgY2FzZSBBdmVyYWdlTWV0aG9kLk1hY3JvOiByZXR1cm4gdGhpcy5tYWNyb1JlY2FsbCgpO1xuICAgICAgICAgICAgY2FzZSBBdmVyYWdlTWV0aG9kLldlaWdodGVkOiByZXR1cm4gdGhpcy53ZWlnaHRlZFJlY2FsbCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICogR2l2ZXMgdGhlIHJlY2FsbCB2YWx1ZSBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXgsIHRha2luZyBpbiBhY2NvdW50IHRoZSBtaWNybyBhdmVyYWdlIG1ldGhvZC5cbiAgICAqXG4gICAgKiBSZWNhbGwsIGFsc28ga25vdyBhcyB0cnVlIHBvc2l0aXZlIHJhdGUsIHNlbnNpdGl2aXR5LCBoaXQgcmF0ZSBhbmQgcHJvYmFiaWxpdHkgb2YgZGV0ZWN0aW9uLFxuICAgICogZ2l2ZXMgd2hhdCBmcmFjdGlvbiBvZiBhbGwgcG9zaXRpdmVzIGNsYXNzZXMgY29ycmVjdGx5IHByZWRpY3RlZCBhcyBwb3NpdGl2ZS5cbiAgICAqXG4gICAgKiBUaGUgbWljcm8gYXZlcmFnZSBtZXRob2QgY2FsY3VsYXRlcyBhbmQgc3VtcyB0aGUgcmVjYWxsIGZvciBlYWNoIGluZGl2aWR1YWwgbGFiZWwgYW5kIGRpdmlkZXMgZm9yXG4gICAgKiB0aGUgbnVtYmVyIG9mIGxhYmVscy5cbiAgICAqXG4gICAgKiBAcmV0dXJuIFRoZSBtaWNybyByZWNhbGwgdmFsdWUuXG4gICAgKi9cbiAgICBtaWNyb1JlY2FsbCgpIHtcbiAgICAgICAgY29uc3QgeyB0cnVlUG9zaXRpdmUsIGZhbHNlTmVnYXRpdmUgfSA9IHRoaXMuZ2V0U3VtQ29uZnVzaW9uTWF0cml4Q2xhc3NlcygpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSAodHJ1ZVBvc2l0aXZlKSAvICh0cnVlUG9zaXRpdmUgKyBmYWxzZU5lZ2F0aXZlKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdCB8fCAwO1xuICAgIH1cbiAgICAvKipcbiAgICAqIEdpdmVzIHRoZSByZWNhbGwgdmFsdWUgZm9yIGFsbCBjb25mdXNpb24gbWF0cml4LCB0YWtpbmcgaW4gYWNjb3VudCB0aGUgbWFjcm8gYXZlcmFnZSBtZXRob2QuXG4gICAgKlxuICAgICogUmVjYWxsLCBhbHNvIGtub3cgYXMgdHJ1ZSBwb3NpdGl2ZSByYXRlLCBzZW5zaXRpdml0eSwgaGl0IHJhdGUgYW5kIHByb2JhYmlsaXR5IG9mIGRldGVjdGlvbixcbiAgICAqIGdpdmVzIHdoYXQgZnJhY3Rpb24gb2YgYWxsIHBvc2l0aXZlcyBjbGFzc2VzIGNvcnJlY3RseSBwcmVkaWN0ZWQgYXMgcG9zaXRpdmUuXG4gICAgKlxuICAgICogVGhlIG1hY3JvIGF2ZXJhZ2UgbWV0aG9kIGNhbGN1bGF0ZXMgYW5kIHN1bXMgdGhlIHJlY2FsbCBmb3IgZWFjaCBpbmRpdmlkdWFsIGxhYmVsIGFuZCBkaXZpZGVzIGZvclxuICAgICogdGhlIG51bWJlciBvZiBsYWJlbHMuXG4gICAgKlxuICAgICogQHJldHVybiBUaGUgbWFjcm8gcmVjYWxsIHZhbHVlLlxuICAgICovXG4gICAgbWFjcm9SZWNhbGwoKSB7XG4gICAgICAgIGxldCBzdW0gPSAwO1xuICAgICAgICB0aGlzLmxhYmVscy5mb3JFYWNoKChsYWJlbCkgPT4gc3VtICs9IHRoaXMubGFiZWxSZWNhbGwobGFiZWwpKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gc3VtIC8gdGhpcy5sYWJlbHMubGVuZ3RoO1xuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICogR2l2ZXMgdGhlIHJlY2FsbCB2YWx1ZSBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXgsIHRha2luZyBpbiBhY2NvdW50IHRoZSBhdmVyYWdlIHdlaWdodGVkIG1ldGhvZC5cbiAgICAqXG4gICAgKiBSZWNhbGwsIGFsc28ga25vdyBhcyB0cnVlIHBvc2l0aXZlIHJhdGUsIHNlbnNpdGl2aXR5LCBoaXQgcmF0ZSBhbmQgcHJvYmFiaWxpdHkgb2YgZGV0ZWN0aW9uLFxuICAgICogZ2l2ZXMgd2hhdCBmcmFjdGlvbiBvZiBhbGwgcG9zaXRpdmVzIGNsYXNzZXMgY29ycmVjdGx5IHByZWRpY3RlZCBhcyBwb3NpdGl2ZS5cbiAgICAqXG4gICAgKiBUaGUgd2VpZ2h0ZWQgYXZlcmFnZSBtZXRob2QgZ2l2ZXMgdGhlIGxhYmVscyB3aXRoIG1vcmUgcHJlZGljdGlvbnMgbW9yZSBpbXBvcnRhbmNlICh3ZWlnaHQpXG4gICAgKiBpbiB0aGUgZmluYWwgcmVjYWxsIHZhbHVlIGNvbXBhcmluZyB3aXRoIGxhYmVscyB3aXRoIGxlc3MgcHJlZGljdGlvbnMuXG4gICAgKlxuICAgICogQHJldHVybiBUaGUgd2VpZ2h0ZWQgcmVjYWxsIHZhbHVlLlxuICAgICovXG4gICAgd2VpZ2h0ZWRSZWNhbGwoKSB7XG4gICAgICAgIGNvbnN0IHN1bUxhYmVscyA9IHRoaXMuZ2V0TGFiZWxzUHJlZGljdGlvbnNTdW0oKTtcbiAgICAgICAgY29uc3QgbnVtYmVyT2ZQcmVkaWN0aW9ucyA9IHRoaXMuZ2V0TnVtYmVyT2ZQcmVkaWN0aW9ucygpO1xuICAgICAgICBsZXQgc3VtID0gMDtcbiAgICAgICAgdGhpcy5sYWJlbHMuZm9yRWFjaCgobGFiZWwsIGluZGV4KSA9PiBzdW0gKz0gKHRoaXMubGFiZWxSZWNhbGwobGFiZWwpICogc3VtTGFiZWxzW2luZGV4XSkpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBzdW0gLyBudW1iZXJPZlByZWRpY3Rpb25zO1xuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmljaXR5IGFsc28ga25vdyBhcyBzZWxlY3Rpdml0eSBvciB0cnVlIG5lZ2F0aXZlIHJhdGUsXG4gICAgICogZ2l2ZXMgd2hhdCBmcmFjdGlvbiBvZiBhbGwgbmVnYXRpdmVzIHNhbXBsZXMgYXJlIGNvcnJlY3RseSBhcyBuZWdhdGl2ZS5cbiAgICAgKlxuICAgICAqIEZvcm11bGE6XG4gICAgICpcbiAgICAgKiBzcGVjaWZpY2l0eSA9IFRQIC8gKFROICsgRk4pXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29uZmlndXJhdGlvbiBTZXQgb2YgY29uZmlndXJhdGlvbnMgdXNlZCBvbiBzcGVjaWZpY2l0eSBjYWxjdWxhdGlvbnMuXG4gICAgICpcbiAgICAgKiBbW2NvbmZpZ3VyYXRpb24ubGFiZWxdXSA6IFRoZSBsYWJlbCBuYW1lIHdoaWNoIHdpbGwgYmUgdXNlZCB0byBjYWxjdWxhdGUgdGhlIHNwZWNpZmljaXR5IHZhbHVlLlxuICAgICAqIElmIHVuZGVmaW5lZCBvciBudWxsLCB0aGUgdmFsdWUgd2lsbCBiZSBjYWxjdWxhdGVkIGZvciBhbGwgY29uZnVzaW9uIG1hdHJpeC5cbiAgICAgKlxuICAgICAqIFtbY29uZmlndXJhdGlvbi5hdmVyYWdlXV06IERlZmluZXMgd2hpY2ggdHlwZSBvZiBhdmVyYWdlIHNob3VsZCBiZSB1c2VkLiBUaGlzIGF2ZXJhZ2Ugd2lsbCBvbmx5IGJlIHRha2VuIGluIGFjY291bnQuXG4gICAgICogb24gbWF0cml4IGNhbGN1bGF0aW9ucyAod2hlbiBsYWJlbCA9IG51bGwgfHwgdW5kZWZpbmVkKS5cbiAgICAgKlxuICAgICAqIFtbY29uZmlndXJhdGlvbi5hdmVyYWdlLk1pY3JvXV06IENhbGN1bGF0ZXMgdGhlIFRQLCBUTiwgRlAgYW5kIEZOIGZvciB0aGUgbWF0cml4IGdsb2JhbGx5IGFuZCB0aGVuIGFwcGxpZXMgdGhlXG4gICAgICogc3BlY2lmaWNpdHkgZm9ybXVsYS5cbiAgICAgKlxuICAgICAqIFtbY29uZmlndXJhdGlvbi5hdmVyYWdlLk1hY3JvXV06IENhbGN1bGF0ZXMgYW5kIHN1bXMgdGhlIG1pc3MgY2xhc3NpZmljYXRpb24gcmF0ZSBmb3IgZWFjaCBpbmRpdmlkdWFsIGxhYmVsIGFuZCBkaXZpZGVzIGZvclxuICAgICAqIHRoZSBudW1iZXIgb2YgbGFiZWxzLlxuICAgICAqXG4gICAgICogW1tjb25maWd1cmF0aW9uLmF2ZXJhZ2UuV2VpZ2h0ZWRdXTogRGVmaW5lcyBpZiB0aGUgc3BlY2lmaWNpdHkgY2FsY3VsYXRpb25zIHNob3VsZCBiZSB3ZWlnaHRlZC4gVGhpcyBtZWFucyB0aGUgbGFiZWxzXG4gICAgICogd2l0aCBtb3JlIHByZWRpY3Rpb25zIHdpbGwgd2VpZ2h0IG1vcmUgaW4gdGhlIGZpbmFsIHZhbHVlIGNvbXBhcmluZyB3aXRoIGxhYmVscyB3aXRoIGxlc3MgcHJlZGljdGlvbnMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFRoZSBzcGVjaWZpY2l0eSB2YWx1ZS5cbiAgICAgKi9cbiAgICBzcGVjaWZpY2l0eShjb25maWd1cmF0aW9uID0geyBhdmVyYWdlOiBBdmVyYWdlTWV0aG9kLldlaWdodGVkIH0pIHtcbiAgICAgICAgdGhpcy52YWxpZGF0ZSgpO1xuICAgICAgICBpZiAoKGNvbmZpZ3VyYXRpb24gPT09IG51bGwgfHwgY29uZmlndXJhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29uZmlndXJhdGlvbi5sYWJlbCkgJiYgKGNvbmZpZ3VyYXRpb24gPT09IG51bGwgfHwgY29uZmlndXJhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29uZmlndXJhdGlvbi5sYWJlbC5sZW5ndGgpID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGFiZWxTcGVjaWZpY2l0eShjb25maWd1cmF0aW9uLmxhYmVsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXhTcGVjaWZpY2l0eShjb25maWd1cmF0aW9uID09PSBudWxsIHx8IGNvbmZpZ3VyYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbmZpZ3VyYXRpb24uYXZlcmFnZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdpdmVzIHRoZSBzcGVjaWZpY2l0eSB2YWx1ZSBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXgsXG4gICAgICogdGFraW5nIGluIGFjY291bnQgYSBnaXZlbiBhdmVyYWdlIG1ldGhvZCBvZiBjYWxjdWxhdGlvbi5cbiAgICAgKlxuICAgICAqIFNwZWNpZmljaXR5IGFsc28ga25vdyBhcyBzZWxlY3Rpdml0eSBvciB0cnVlIG5lZ2F0aXZlIHJhdGUsXG4gICAgICogZ2l2ZXMgd2hhdCBmcmFjdGlvbiBvZiBhbGwgbmVnYXRpdmVzIHNhbXBsZXMgYXJlIGNvcnJlY3RseSBhcyBuZWdhdGl2ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBhdmVyYWdlIERlZmluZXMgd2hpY2ggdHlwZSBvZiBhdmVyYWdlIHNob3VsZCBiZSB1c2VkLiBUaGlzIGF2ZXJhZ2Ugd2lsbCBvbmx5IGJlIHRha2VuIGluIGFjY291bnQuXG4gICAgICogb24gbWF0cml4IGNhbGN1bGF0aW9ucyAod2hlbiBsYWJlbCA9IG51bGwgfHwgdW5kZWZpbmVkKS5cbiAgICAgKlxuICAgICAqIFtbYXZlcmFnZS5NaWNyb11dOiBDYWxjdWxhdGVzIHRoZSBUUCwgVE4sIEZQIGFuZCBGTiBmb3IgdGhlIG1hdHJpeCBnbG9iYWxseSBhbmQgdGhlbiBhcHBsaWVzIHRoZVxuICAgICAqIHNwZWNpZmljaXR5IGZvcm11bGEuXG4gICAgICpcbiAgICAgKiBbW2F2ZXJhZ2UuTWFjcm9dXTogQ2FsY3VsYXRlcyBhbmQgc3VtcyB0aGUgc3BlY2lmaWNpdHkgZm9yIGVhY2ggaW5kaXZpZHVhbCBsYWJlbCBhbmQgZGl2aWRlcyBmb3JcbiAgICAgKiB0aGUgbnVtYmVyIG9mIGxhYmVscy5cbiAgICAgKlxuICAgICAqIFtbYXZlcmFnZS5XZWlnaHRlZF1dOiBEZWZpbmVzIGlmIHRoZSBzcGVjaWZpY2l0eSBjYWxjdWxhdGlvbnMgc2hvdWxkIGJlIHdlaWdodGVkLiBUaGlzIG1lYW5zIHRoZSBsYWJlbHNcbiAgICAgKiB3aXRoIG1vcmUgcHJlZGljdGlvbnMgd2lsbCB3ZWlnaHQgbW9yZSBpbiB0aGUgZmluYWwgc3BlY2lmaWNpdHkgdmFsdWUgY29tcGFyaW5nIHdpdGggbGFiZWxzIHdpdGggbGVzcy5cbiAgICAgKiBwcmVkaWN0aW9ucy5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gVGhlIHNwZWNpZmljaXR5IHZhbHVlLlxuICAgICAqL1xuICAgIG1hdHJpeFNwZWNpZmljaXR5KGF2ZXJhZ2UgPSBBdmVyYWdlTWV0aG9kLldlaWdodGVkKSB7XG4gICAgICAgIHRoaXMudmFsaWRhdGUoKTtcbiAgICAgICAgc3dpdGNoIChhdmVyYWdlKSB7XG4gICAgICAgICAgICBjYXNlIEF2ZXJhZ2VNZXRob2QuTWljcm86IHJldHVybiB0aGlzLm1pY3JvU3BlY2lmaWNpdHkoKTtcbiAgICAgICAgICAgIGNhc2UgQXZlcmFnZU1ldGhvZC5NYWNybzogcmV0dXJuIHRoaXMubWFjcm9TcGVjaWZpY2l0eSgpO1xuICAgICAgICAgICAgY2FzZSBBdmVyYWdlTWV0aG9kLldlaWdodGVkOiByZXR1cm4gdGhpcy53ZWlnaHRlZFNwZWNpZmljaXR5KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgKiBHaXZlcyB0aGUgc3BlY2lmaWNpdHkgdmFsdWUgZm9yIGFsbCBjb25mdXNpb24gbWF0cml4LCB0YWtpbmcgaW4gYWNjb3VudCB0aGUgbWljcm8gYXZlcmFnZSBtZXRob2QuXG4gICAgKlxuICAgICogU3BlY2lmaWNpdHkgYWxzbyBrbm93IGFzIHNlbGVjdGl2aXR5IG9yIHRydWUgbmVnYXRpdmUgcmF0ZSxcbiAgICAqIGdpdmVzIHdoYXQgZnJhY3Rpb24gb2YgYWxsIG5lZ2F0aXZlcyBzYW1wbGVzIGFyZSBjb3JyZWN0bHkgYXMgbmVnYXRpdmUuXG4gICAgKlxuICAgICogVGhlIG1pY3JvIGF2ZXJhZ2UgbWV0aG9kIGNhbGN1bGF0ZXMgYW5kIHN1bXMgdGhlIHNwZWNpZmljaXR5IGZvciBlYWNoIGluZGl2aWR1YWwgbGFiZWwgYW5kIGRpdmlkZXMgZm9yXG4gICAgKiB0aGUgbnVtYmVyIG9mIGxhYmVscy5cbiAgICAqXG4gICAgKiBAcmV0dXJuIFRoZSBtaWNybyBzcGVjaWZpY2l0eSB2YWx1ZS5cbiAgICAqL1xuICAgIG1pY3JvU3BlY2lmaWNpdHkoKSB7XG4gICAgICAgIGNvbnN0IHsgdHJ1ZU5lZ2F0aXZlLCBmYWxzZVBvc2l0aXZlIH0gPSB0aGlzLmdldFN1bUNvbmZ1c2lvbk1hdHJpeENsYXNzZXMoKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gKHRydWVOZWdhdGl2ZSkgLyAodHJ1ZU5lZ2F0aXZlICsgZmFsc2VQb3NpdGl2ZSk7XG4gICAgICAgIHJldHVybiByZXN1bHQgfHwgMDtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBHaXZlcyB0aGUgc3BlY2lmaWNpdHkgdmFsdWUgZm9yIGFsbCBjb25mdXNpb24gbWF0cml4LCB0YWtpbmcgaW4gYWNjb3VudCB0aGUgbWFjcm8gYXZlcmFnZSBtZXRob2QuXG4gICAgKlxuICAgICogU3BlY2lmaWNpdHkgYWxzbyBrbm93IGFzIHNlbGVjdGl2aXR5IG9yIHRydWUgbmVnYXRpdmUgcmF0ZSxcbiAgICAqIGdpdmVzIHdoYXQgZnJhY3Rpb24gb2YgYWxsIG5lZ2F0aXZlcyBzYW1wbGVzIGFyZSBjb3JyZWN0bHkgYXMgbmVnYXRpdmUuXG4gICAgKlxuICAgICogVGhlIG1hY3JvIGF2ZXJhZ2UgbWV0aG9kIGNhbGN1bGF0ZXMgYW5kIHN1bXMgdGhlIHNwZWNpZmljaXR5IGZvciBlYWNoIGluZGl2aWR1YWwgbGFiZWwgYW5kIGRpdmlkZXMgZm9yXG4gICAgKiB0aGUgbnVtYmVyIG9mIGxhYmVscy5cbiAgICAqXG4gICAgKiBAcmV0dXJuIFRoZSBtYWNybyBzcGVjaWZpY2l0eSB2YWx1ZS5cbiAgICAqL1xuICAgIG1hY3JvU3BlY2lmaWNpdHkoKSB7XG4gICAgICAgIGxldCBzdW0gPSAwO1xuICAgICAgICB0aGlzLmxhYmVscy5mb3JFYWNoKChsYWJlbCkgPT4gc3VtICs9IHRoaXMubGFiZWxTcGVjaWZpY2l0eShsYWJlbCkpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBzdW0gLyB0aGlzLmxhYmVscy5sZW5ndGg7XG4gICAgICAgIHJldHVybiByZXN1bHQgfHwgMDtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBHaXZlcyB0aGUgc3BlY2lmaWNpdHkgdmFsdWUgZm9yIGFsbCBjb25mdXNpb24gbWF0cml4LCB0YWtpbmcgaW4gYWNjb3VudCB0aGUgYXZlcmFnZSB3ZWlnaHRlZCBtZXRob2QuXG4gICAgKlxuICAgICogU3BlY2lmaWNpdHkgYWxzbyBrbm93IGFzIHNlbGVjdGl2aXR5IG9yIHRydWUgbmVnYXRpdmUgcmF0ZSxcbiAgICAqIGdpdmVzIHdoYXQgZnJhY3Rpb24gb2YgYWxsIG5lZ2F0aXZlcyBzYW1wbGVzIGFyZSBjb3JyZWN0bHkgYXMgbmVnYXRpdmUuXG4gICAgKlxuICAgICogVGhlIHdlaWdodGVkIGF2ZXJhZ2UgbWV0aG9kIGdpdmVzIHRoZSBsYWJlbHMgd2l0aCBtb3JlIHByZWRpY3Rpb25zIG1vcmUgaW1wb3J0YW5jZSAod2VpZ2h0KVxuICAgICogaW4gdGhlIGZpbmFsIHNwZWNpZmljaXR5IHZhbHVlIGNvbXBhcmluZyB3aXRoIGxhYmVscyB3aXRoIGxlc3MgcHJlZGljdGlvbnMuXG4gICAgKlxuICAgICogQHJldHVybiBUaGUgd2VpZ2h0ZWQgc3BlY2lmaWNpdHkgdmFsdWUuXG4gICAgKi9cbiAgICB3ZWlnaHRlZFNwZWNpZmljaXR5KCkge1xuICAgICAgICBjb25zdCBzdW1MYWJlbHMgPSB0aGlzLmdldExhYmVsc1ByZWRpY3Rpb25zU3VtKCk7XG4gICAgICAgIGNvbnN0IG51bWJlck9mUHJlZGljdGlvbnMgPSB0aGlzLmdldE51bWJlck9mUHJlZGljdGlvbnMoKTtcbiAgICAgICAgbGV0IHN1bSA9IDA7XG4gICAgICAgIHRoaXMubGFiZWxzLmZvckVhY2goKGxhYmVsLCBpbmRleCkgPT4gc3VtICs9ICh0aGlzLmxhYmVsU3BlY2lmaWNpdHkobGFiZWwpICogc3VtTGFiZWxzW2luZGV4XSkpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBzdW0gLyBudW1iZXJPZlByZWRpY3Rpb25zO1xuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdpdmVzIHRoZSBzcGVjaWZpY2l0eSB2YWx1ZSBmb3IgYSBnaXZlbiBtYXRyaXggbGFiZWwuXG4gICAgICpcbiAgICAgKiBTcGVjaWZpY2l0eSBhbHNvIGtub3cgYXMgc2VsZWN0aXZpdHkgb3IgdHJ1ZSBuZWdhdGl2ZSByYXRlLFxuICAgICAqIGdpdmVzIHdoYXQgZnJhY3Rpb24gb2YgYWxsIG5lZ2F0aXZlcyBzYW1wbGVzIGFyZSBjb3JyZWN0bHkgYXMgbmVnYXRpdmUuXG4gICAgICpcbiAgICAgKiBGb3JtdWxhOlxuICAgICAqXG4gICAgICogc3BlY2lmaWNpdHkgPSBUUCAvIChUTiArIEZOKVxuICAgICAqXG4gICAgICogQHBhcmFtIGxhYmVsIFRoZSBsYWJlbCB1c2VkIHRvIGdldCB0aGUgc3BlY2lmaWNpdHkgdmFsdWUuXG4gICAgICogQHJldHVybiBTcGVjaWZpY2l0eSB2YWx1ZSBmb3IgYSBnaXZlbiBsYWJlbC5cbiAgICAgKi9cbiAgICBsYWJlbFNwZWNpZmljaXR5KGxhYmVsKSB7XG4gICAgICAgIHRoaXMudmFsaWRhdGUoKTtcbiAgICAgICAgY29uc3QgeyB0cnVlTmVnYXRpdmUsIGZhbHNlUG9zaXRpdmUgfSA9IHRoaXMuZ2V0Q29uZnVzaW9uTWF0cml4Q2xhc3NlcyhsYWJlbCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9ICh0cnVlTmVnYXRpdmUpIC8gKHRydWVOZWdhdGl2ZSArIGZhbHNlUG9zaXRpdmUpO1xuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEYxIFNjb3JlIGlzIHRoZSBoYXJtb25pYyBtZWFuIG9mIHByZWNpc2lvbiBhbmQgcmVjYWxsLlxuICAgICAqXG4gICAgICogRm9ybXVsYTpcbiAgICAgKlxuICAgICAqIGYxU2NvcmUgPSBUUCAvIChUTiArIEZOKVxuICAgICAqXG4gICAgICogQHBhcmFtIGNvbmZpZ3VyYXRpb24gU2V0IG9mIGNvbmZpZ3VyYXRpb25zIHVzZWQgb24gRjEgU2NvcmUgY2FsY3VsYXRpb25zLlxuICAgICAqXG4gICAgICogW1tjb25maWd1cmF0aW9uLmxhYmVsXV0gOiBUaGUgbGFiZWwgbmFtZSB3aGljaCB3aWxsIGJlIHVzZWQgdG8gY2FsY3VsYXRlIHRoZSBGMSBTY29yZSB2YWx1ZS5cbiAgICAgKiBJZiB1bmRlZmluZWQgb3IgbnVsbCwgdGhlIHZhbHVlIHdpbGwgYmUgY2FsY3VsYXRlZCBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXguXG4gICAgICpcbiAgICAgKiBbW2NvbmZpZ3VyYXRpb24uYXZlcmFnZV1dOiBEZWZpbmVzIHdoaWNoIHR5cGUgb2YgYXZlcmFnZSBzaG91bGQgYmUgdXNlZC4gVGhpcyBhdmVyYWdlIHdpbGwgb25seSBiZSB0YWtlbiBpbiBhY2NvdW50LlxuICAgICAqIG9uIG1hdHJpeCBjYWxjdWxhdGlvbnMgKHdoZW4gbGFiZWwgPSBudWxsIHx8IHVuZGVmaW5lZCkuXG4gICAgICpcbiAgICAgKiBbW2NvbmZpZ3VyYXRpb24uYXZlcmFnZS5NaWNyb11dOiBDYWxjdWxhdGVzIHRoZSBUUCwgVE4sIEZQIGFuZCBGTiBmb3IgdGhlIG1hdHJpeCBnbG9iYWxseSBhbmQgdGhlbiBhcHBsaWVzIHRoZVxuICAgICAqIEYxIFNjb3JlIGZvcm11bGEuXG4gICAgICpcbiAgICAgKiBbW2NvbmZpZ3VyYXRpb24uYXZlcmFnZS5NYWNyb11dOiBDYWxjdWxhdGVzIGFuZCBzdW1zIHRoZSBtaXNzIGNsYXNzaWZpY2F0aW9uIHJhdGUgZm9yIGVhY2ggaW5kaXZpZHVhbCBsYWJlbCBhbmQgZGl2aWRlcyBmb3JcbiAgICAgKiB0aGUgbnVtYmVyIG9mIGxhYmVscy5cbiAgICAgKlxuICAgICAqIFtbY29uZmlndXJhdGlvbi5hdmVyYWdlLldlaWdodGVkXV06IERlZmluZXMgaWYgdGhlIEYxIFNjb3JlIGNhbGN1bGF0aW9ucyBzaG91bGQgYmUgd2VpZ2h0ZWQuIFRoaXMgbWVhbnMgdGhlIGxhYmVsc1xuICAgICAqIHdpdGggbW9yZSBwcmVkaWN0aW9ucyB3aWxsIHdlaWdodCBtb3JlIGluIHRoZSBmaW5hbCB2YWx1ZSBjb21wYXJpbmcgd2l0aCBsYWJlbHMgd2l0aCBsZXNzIHByZWRpY3Rpb25zLlxuICAgICAqXG4gICAgICogQHJldHVybiBUaGUgRjEgU2NvcmUgdmFsdWUuXG4gICAgICovXG4gICAgZjFTY29yZShjb25maWd1cmF0aW9uKSB7XG4gICAgICAgIHRoaXMudmFsaWRhdGUoKTtcbiAgICAgICAgaWYgKChjb25maWd1cmF0aW9uID09PSBudWxsIHx8IGNvbmZpZ3VyYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbmZpZ3VyYXRpb24ubGFiZWwpICYmIChjb25maWd1cmF0aW9uID09PSBudWxsIHx8IGNvbmZpZ3VyYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbmZpZ3VyYXRpb24ubGFiZWwubGVuZ3RoKSA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxhYmVsRjFTY29yZShjb25maWd1cmF0aW9uLmxhYmVsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXhGMVNjb3JlKGNvbmZpZ3VyYXRpb24gPT09IG51bGwgfHwgY29uZmlndXJhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29uZmlndXJhdGlvbi5hdmVyYWdlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2l2ZXMgdGhlIEYxIFNjb3JlIHZhbHVlIGZvciBhbGwgY29uZnVzaW9uIG1hdHJpeCxcbiAgICAgKiB0YWtpbmcgaW4gYWNjb3VudCBhIGdpdmVuIGF2ZXJhZ2UgbWV0aG9kIG9mIGNhbGN1bGF0aW9uLlxuICAgICAqXG4gICAgICogRjEgU2NvcmUgaXMgdGhlIGhhcm1vbmljIG1lYW4gb2YgcHJlY2lzaW9uIGFuZCByZWNhbGwuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYXZlcmFnZSBEZWZpbmVzIHdoaWNoIHR5cGUgb2YgYXZlcmFnZSBzaG91bGQgYmUgdXNlZC4gVGhpcyBhdmVyYWdlIHdpbGwgb25seSBiZSB0YWtlbiBpbiBhY2NvdW50LlxuICAgICAqIG9uIG1hdHJpeCBjYWxjdWxhdGlvbnMgKHdoZW4gbGFiZWwgPSBudWxsIHx8IHVuZGVmaW5lZCkuXG4gICAgICpcbiAgICAgKiBbW2F2ZXJhZ2UuTWljcm9dXTogQ2FsY3VsYXRlcyB0aGUgVFAsIFROLCBGUCBhbmQgRk4gZm9yIHRoZSBtYXRyaXggZ2xvYmFsbHkgYW5kIHRoZW4gYXBwbGllcyB0aGVcbiAgICAgKiBGMSBTY29yZSBmb3JtdWxhLlxuICAgICAqXG4gICAgICogW1thdmVyYWdlLk1hY3JvXV06IENhbGN1bGF0ZXMgYW5kIHN1bXMgdGhlIEYxIFNjb3JlIGZvciBlYWNoIGluZGl2aWR1YWwgbGFiZWwgYW5kIGRpdmlkZXMgZm9yXG4gICAgICogdGhlIG51bWJlciBvZiBsYWJlbHMuXG4gICAgICpcbiAgICAgKiBbW2F2ZXJhZ2UuV2VpZ2h0ZWRdXTogRGVmaW5lcyBpZiB0aGUgRjEgU2NvcmUgY2FsY3VsYXRpb25zIHNob3VsZCBiZSB3ZWlnaHRlZC4gVGhpcyBtZWFucyB0aGUgbGFiZWxzXG4gICAgICogd2l0aCBtb3JlIHByZWRpY3Rpb25zIHdpbGwgd2VpZ2h0IG1vcmUgaW4gdGhlIGZpbmFsIEYxIFNjb3JlIHZhbHVlIGNvbXBhcmluZyB3aXRoIGxhYmVscyB3aXRoIGxlc3MuXG4gICAgICogcHJlZGljdGlvbnMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFRoZSBGMSBTY29yZSB2YWx1ZS5cbiAgICAgKi9cbiAgICBtYXRyaXhGMVNjb3JlKGF2ZXJhZ2UgPSBBdmVyYWdlTWV0aG9kLldlaWdodGVkKSB7XG4gICAgICAgIHRoaXMudmFsaWRhdGUoKTtcbiAgICAgICAgc3dpdGNoIChhdmVyYWdlKSB7XG4gICAgICAgICAgICBjYXNlIEF2ZXJhZ2VNZXRob2QuTWljcm86IHJldHVybiB0aGlzLm1pY3JvRjFTY29yZSgpO1xuICAgICAgICAgICAgY2FzZSBBdmVyYWdlTWV0aG9kLk1hY3JvOiByZXR1cm4gdGhpcy5tYWNyb0YxU2NvcmUoKTtcbiAgICAgICAgICAgIGNhc2UgQXZlcmFnZU1ldGhvZC5XZWlnaHRlZDogcmV0dXJuIHRoaXMud2VpZ2h0ZWRGMVNjb3JlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogR2l2ZXMgdGhlIEYxIFNjb3JlIHZhbHVlIGZvciBhIGdpdmVuIG1hdHJpeCBsYWJlbC5cbiAgICAgKlxuICAgICAqIEYxIFNjb3JlIGlzIHRoZSBoYXJtb25pYyBtZWFuIG9mIHByZWNpc2lvbiBhbmQgcmVjYWxsLlxuICAgICAqXG4gICAgICogRm9ybXVsYTpcbiAgICAgKlxuICAgICAqIGYxU2NvcmUgPSBUUCAvIChUTiArIEZOKVxuICAgICAqXG4gICAgICogQHBhcmFtIGxhYmVsIFRoZSBsYWJlbCB1c2VkIHRvIGdldCB0aGVGIDEgU2NvcmUgdmFsdWUuXG4gICAgICogQHJldHVybiBGMSBTY29yZSB2YWx1ZSBmb3IgYSBnaXZlbiBsYWJlbC5cbiAgICAgKi9cbiAgICBsYWJlbEYxU2NvcmUobGFiZWwpIHtcbiAgICAgICAgdGhpcy52YWxpZGF0ZSgpO1xuICAgICAgICBjb25zdCBwcmVjaXNpb24gPSB0aGlzLnByZWNpc2lvbih7IGxhYmVsIH0pO1xuICAgICAgICBjb25zdCByZWNhbGwgPSB0aGlzLnJlY2FsbCh7IGxhYmVsIH0pO1xuICAgICAgICBjb25zdCByZXN1bHQgPSAyICogKChwcmVjaXNpb24gKiByZWNhbGwpIC8gKHByZWNpc2lvbiArIHJlY2FsbCkpO1xuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICogR2l2ZXMgdGhlIEYxIFNjb3JlIHZhbHVlIGZvciBhbGwgY29uZnVzaW9uIG1hdHJpeCwgdGFraW5nIGluIGFjY291bnQgdGhlIG1pY3JvIGF2ZXJhZ2UgbWV0aG9kLlxuICAgICpcbiAgICAqIEYxIFNjb3JlIGlzIHRoZSBoYXJtb25pYyBtZWFuIG9mIHByZWNpc2lvbiBhbmQgcmVjYWxsLlxuICAgICpcbiAgICAqIFRoZSBtaWNybyBhdmVyYWdlIG1ldGhvZCBjYWxjdWxhdGVzIGFuZCBzdW1zIHRoZSBGMSBTY29yZSBmb3IgZWFjaCBpbmRpdmlkdWFsIGxhYmVsIGFuZCBkaXZpZGVzIGZvclxuICAgICogdGhlIG51bWJlciBvZiBsYWJlbHMuXG4gICAgKlxuICAgICogQHJldHVybiBUaGUgbWljcm8gRjEgU2NvcmUgdmFsdWUuXG4gICAgKi9cbiAgICBtaWNyb0YxU2NvcmUoKSB7XG4gICAgICAgIGNvbnN0IHByZWNpc2lvbiA9IHRoaXMubWljcm9QcmVjaXNpb24oKTtcbiAgICAgICAgY29uc3QgcmVjYWxsID0gdGhpcy5taWNyb1JlY2FsbCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseUYxU2NvcmVGb3JtdWxhKHByZWNpc2lvbiwgcmVjYWxsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBHaXZlcyB0aGUgRjEgU2NvcmUgdmFsdWUgZm9yIGFsbCBjb25mdXNpb24gbWF0cml4LCB0YWtpbmcgaW4gYWNjb3VudCB0aGUgbWFjcm8gYXZlcmFnZSBtZXRob2QuXG4gICAgKlxuICAgICogRjEgU2NvcmUgaXMgdGhlIGhhcm1vbmljIG1lYW4gb2YgcHJlY2lzaW9uIGFuZCByZWNhbGwuXG4gICAgKlxuICAgICogVGhlIG1hY3JvIGF2ZXJhZ2UgbWV0aG9kIGNhbGN1bGF0ZXMgYW5kIHN1bXMgdGhlIEYxIFNjb3JlIGZvciBlYWNoIGluZGl2aWR1YWwgbGFiZWwgYW5kIGRpdmlkZXMgZm9yXG4gICAgKiB0aGUgbnVtYmVyIG9mIGxhYmVscy5cbiAgICAqXG4gICAgKiBAcmV0dXJuIFRoZSBtYWNybyBGMSBTY29yZSB2YWx1ZS5cbiAgICAqL1xuICAgIG1hY3JvRjFTY29yZSgpIHtcbiAgICAgICAgbGV0IHN1bSA9IDA7XG4gICAgICAgIHRoaXMubGFiZWxzLmZvckVhY2goKGxhYmVsKSA9PiBzdW0gKz0gdGhpcy5sYWJlbEYxU2NvcmUobGFiZWwpKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gc3VtIC8gdGhpcy5sYWJlbHMubGVuZ3RoO1xuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICogR2l2ZXMgdGhlIEYxIFNjb3JlIHZhbHVlIGZvciBhbGwgY29uZnVzaW9uIG1hdHJpeCwgdGFraW5nIGluIGFjY291bnQgdGhlIGF2ZXJhZ2Ugd2VpZ2h0ZWQgbWV0aG9kLlxuICAgICpcbiAgICAqIEYxIFNjb3JlIGlzIHRoZSBoYXJtb25pYyBtZWFuIG9mIHByZWNpc2lvbiBhbmQgcmVjYWxsLlxuICAgICpcbiAgICAqIFRoZSB3ZWlnaHRlZCBhdmVyYWdlIG1ldGhvZCBnaXZlcyB0aGUgbGFiZWxzIHdpdGggbW9yZSBwcmVkaWN0aW9ucyBtb3JlIGltcG9ydGFuY2UgKHdlaWdodClcbiAgICAqIGluIHRoZSBmaW5hbCBGMSBTY29yZSB2YWx1ZSBjb21wYXJpbmcgd2l0aCBsYWJlbHMgd2l0aCBsZXNzIHByZWRpY3Rpb25zLlxuICAgICpcbiAgICAqIEByZXR1cm4gVGhlIHdlaWdodGVkIEYxIFNjb3JlIHZhbHVlLlxuICAgICovXG4gICAgd2VpZ2h0ZWRGMVNjb3JlKCkge1xuICAgICAgICBjb25zdCBzdW1MYWJlbHMgPSB0aGlzLmdldExhYmVsc1ByZWRpY3Rpb25zU3VtKCk7XG4gICAgICAgIGNvbnN0IG51bWJlck9mUHJlZGljdGlvbnMgPSB0aGlzLmdldE51bWJlck9mUHJlZGljdGlvbnMoKTtcbiAgICAgICAgbGV0IHN1bSA9IDA7XG4gICAgICAgIHRoaXMubGFiZWxzLmZvckVhY2goKGxhYmVsLCBpbmRleCkgPT4gc3VtICs9ICh0aGlzLmxhYmVsRjFTY29yZShsYWJlbCkgKiBzdW1MYWJlbHNbaW5kZXhdKSk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHN1bSAvIG51bWJlck9mUHJlZGljdGlvbnM7XG4gICAgICAgIHJldHVybiByZXN1bHQgfHwgMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGFsbCBtYXRyaXggY2xhc3NlcywgY29udGFpbmluZyBpbmZvcm1hdGlvbiBhYm91dCB0cnVlIHBvc2l0aXZlcywgdHJ1ZSBuZWdhdGl2ZXMsXG4gICAgICogZmFsc2UgcG9zaXRpdmVzIGFuZCBmYWxzZSBuZWdhdGl2ZXMsIGFzIHdlbGwgYXMgdGhlIGxhYmVsIGFzc29jaWF0ZWQgd2l0aCBpdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gQW4gYXJyYXkgb2YgbWF0cml4IGNsYXNzZXMgY29udGFpbmluZyBpbmZvcm1hdGlvbiBhYm91dCB0cnVlIHBvc2l0aXZlcywgdHJ1ZSBuZWdhdGl2ZXMsXG4gICAgICogZmFsc2UgcG9zaXRpdmVzIGFuZCBmYWxzZSBuZWdhdGl2ZXMsIGFzIHdlbGwgYXMgdGhlIGxhYmVsIGFzc29jaWF0ZWQgd2l0aCBpdC5cbiAgICAgKlxuICAgICAqIEBub3RlIENvbnN1bHQgW3dpa2lwZWRpYV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ29uZnVzaW9uX21hdHJpeCkgZm9yIG1vcmVcbiAgICAgKiBpbmZvcm1hdGlvbiByZWdhcmRpbmcgdGVybWlub2xvZ3ksIGZvcm11bGFzIGFuZCBvdGhlciB0aGVvcmV0aWNhbCBjb25jZXB0cy5cbiAgICAgKi9cbiAgICBnZXRBbGxNYXRyaXhDbGFzc2VzKCkge1xuICAgICAgICB0aGlzLnZhbGlkYXRlKCk7XG4gICAgICAgIGNvbnN0IGFsbCA9IG5ldyBBcnJheSgpO1xuICAgICAgICB0aGlzLmxhYmVscy5mb3JFYWNoKChsYWJlbCkgPT4gYWxsLnB1c2goe1xuICAgICAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICAgICAgY29uZnVzaW9uTWF0cml4Q2xhc3NlczogdGhpcy5nZXRDb25mdXNpb25NYXRyaXhDbGFzc2VzKGxhYmVsKVxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBhbGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIHN1bSBvZiBhbGwgY29uZnVzaW9uIG1hdHJpeCBwcmVkaWN0aW9ucywgZGVmaW5lZCBieSBjbGFzc2VzLlxuICAgICAqIEByZXR1cm4gU3VtIG9mIGFsbCBwcmVkaWN0aW9ucywgZGVmaW5lZCBieSBjbGFzc2VzLlxuICAgICAqL1xuICAgIGdldFN1bUNvbmZ1c2lvbk1hdHJpeENsYXNzZXMoKSB7XG4gICAgICAgIGNvbnN0IGNsYXNzZXNTdW0gPSB7XG4gICAgICAgICAgICB0cnVlUG9zaXRpdmU6IDAsXG4gICAgICAgICAgICB0cnVlTmVnYXRpdmU6IDAsXG4gICAgICAgICAgICBmYWxzZVBvc2l0aXZlOiAwLFxuICAgICAgICAgICAgZmFsc2VOZWdhdGl2ZTogMFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBjbGFzc2VzID0gdGhpcy5nZXRBbGxNYXRyaXhDbGFzc2VzKCk7XG4gICAgICAgIGNsYXNzZXMuZm9yRWFjaCgodmFsdWUpID0+IHtcbiAgICAgICAgICAgIGNsYXNzZXNTdW0udHJ1ZVBvc2l0aXZlICs9IHZhbHVlLmNvbmZ1c2lvbk1hdHJpeENsYXNzZXMudHJ1ZVBvc2l0aXZlO1xuICAgICAgICAgICAgY2xhc3Nlc1N1bS50cnVlTmVnYXRpdmUgKz0gdmFsdWUuY29uZnVzaW9uTWF0cml4Q2xhc3Nlcy50cnVlTmVnYXRpdmU7XG4gICAgICAgICAgICBjbGFzc2VzU3VtLmZhbHNlUG9zaXRpdmUgKz0gdmFsdWUuY29uZnVzaW9uTWF0cml4Q2xhc3Nlcy5mYWxzZVBvc2l0aXZlO1xuICAgICAgICAgICAgY2xhc3Nlc1N1bS5mYWxzZU5lZ2F0aXZlICs9IHZhbHVlLmNvbmZ1c2lvbk1hdHJpeENsYXNzZXMuZmFsc2VOZWdhdGl2ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBjbGFzc2VzU3VtO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3Igb25lIGdpdmVuIGxhYmVsLCByZXR1cm5zIHRoZSBtYXRyaXggY2xhc3NlcyAodHJ1ZSBwb3NpdGl2ZXMsIHRydWUgbmVnYXRpdmVzLFxuICAgICAqIGZhbHNlIHBvc2l0aXZlcyBhbmQgZmFsc2UgbmVnYXRpdmVzKS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gVGhlIG1hdHJpeCBjbGFzc2VzICh0cnVlIHBvc2l0aXZlcywgdHJ1ZSBuZWdhdGl2ZXMsXG4gICAgICogZmFsc2UgcG9zaXRpdmVzIGFuZCBmYWxzZSBuZWdhdGl2ZXMpLlxuICAgICAqXG4gICAgICogQG5vdGUgQ29uc3VsdCBbd2lraXBlZGlhXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Db25mdXNpb25fbWF0cml4KSBmb3IgbW9yZVxuICAgICAqIGluZm9ybWF0aW9uIHJlZ2FyZGluZyB0ZXJtaW5vbG9neSwgZm9ybXVsYXMgYW5kIG90aGVyIHRoZW9yZXRpY2FsIGNvbmNlcHRzLlxuICAgICAqL1xuICAgIGdldENvbmZ1c2lvbk1hdHJpeENsYXNzZXMobGFiZWwpIHtcbiAgICAgICAgdGhpcy52YWxpZGF0ZSgpO1xuICAgICAgICBpZiAoIWxhYmVsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgdmFsaWQgbGFiZWwgc2hvdWxkIGJlIHBhc3NlZC4nKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHRoaXMubGFiZWxzLmZpbmRJbmRleChlbGVtZW50ID0+IGVsZW1lbnQgPT09IGxhYmVsKTtcbiAgICAgICAgaWYgKHBvc2l0aW9uID09IC0xKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBsYWJlbCBkb2VzIG5vdCBleGlzdHMgaW4gdGhlIG1hdHJpeC4nKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBudW1iZXJPZlByZWRpY3Rpb25zID0gdGhpcy5nZXROdW1iZXJPZlByZWRpY3Rpb25zKCk7XG4gICAgICAgIGNvbnN0IHRydWVQb3NpdGl2ZSA9IHRoaXMubWF0cml4W3Bvc2l0aW9uXVtwb3NpdGlvbl07XG4gICAgICAgIGNvbnN0IGZhbHNlUG9zaXRpdmUgPSB0aGlzLm1hdHJpeFtwb3NpdGlvbl0ucmVkdWNlKChwcmV2aW91cywgbmV4dCkgPT4gcHJldmlvdXMgKyBuZXh0KSAtIHRydWVQb3NpdGl2ZTtcbiAgICAgICAgbGV0IGZhbHNlTmVnYXRpdmUgPSAwO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubWF0cml4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBmYWxzZU5lZ2F0aXZlICs9IHRoaXMubWF0cml4W2ldW3Bvc2l0aW9uXTtcbiAgICAgICAgfVxuICAgICAgICBmYWxzZU5lZ2F0aXZlIC09IHRydWVQb3NpdGl2ZTtcbiAgICAgICAgY29uc3QgdHJ1ZU5lZ2F0aXZlID0gbnVtYmVyT2ZQcmVkaWN0aW9ucyAtIHRydWVQb3NpdGl2ZSAtIGZhbHNlUG9zaXRpdmUgLSBmYWxzZU5lZ2F0aXZlO1xuICAgICAgICByZXR1cm4geyB0cnVlUG9zaXRpdmUsIHRydWVOZWdhdGl2ZSwgZmFsc2VQb3NpdGl2ZSwgZmFsc2VOZWdhdGl2ZSB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXZlcnRzIHRoZSBsYXN0IG5vcm1hbGl6YXRpb24gb2NjdXIgZ2V0dGluZyB0aGUgY3VycmVudCBjb25mdXNpb24gbWF0cml4LlxuICAgICAqIEByZXR1cm4gVGhlIGNvbmZ1c2lvbiBtYXRyaXggb2JqZWN0IGJlZm9yZSB0aGUgbm9ybWFsaXphdGlvbi5cbiAgICAgKiBJZiB0aGVyZSBpcyBub3QgYW55IGVudHJ5IG9uIHRoZSBoaXN0b3J5LCBudWxsIHdpbGwgYmUgcmV0dXJuZWQuXG4gICAgICovXG4gICAgcmV2ZXJ0Tm9ybWFsaXphdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMubm9ybWFsaXphdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgY20gPSB0aGlzLm5vcm1hbGl6YXRpb25zLnBvcCgpO1xuICAgICAgICAgICAgaWYgKGNtKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRDb25mdXNpb25NYXRyaXgoY20pO1xuICAgICAgICAgICAgICAgIHJldHVybiBjbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVlcCBjbG9uZXMgYW5kIHJldHVybiB0aGUgY3VycmVudCBjb25mdXNpb24gbWF0cml4LlxuICAgICAqIEByZXR1cm4gVGhlIGRlZXAgY2xvbmVkIGNvbmZ1c2lvbiBtYXRyaXggb2JqZWN0LlxuICAgICAqICovXG4gICAgY2xvbmUoKSB7XG4gICAgICAgIGNvbnN0IGNsb25lT2JqID0gbmV3IENvbmZ1c2lvbk1hdHJpeCh7XG4gICAgICAgICAgICBsYWJlbHM6IHRoaXMubGFiZWxzLFxuICAgICAgICAgICAgbWF0cml4OiB0aGlzLm1hdHJpeCxcbiAgICAgICAgfSk7XG4gICAgICAgIGNsb25lT2JqLm5vcm1hbGl6YXRpb25zID0gdGhpcy5kZWVwQ29weSh0aGlzLm5vcm1hbGl6YXRpb25zKTtcbiAgICAgICAgcmV0dXJuIGNsb25lT2JqO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBjb25mdXNpb24gbWF0cml4IG1pbiBhbmQgbWF4IHZhbHVlLlxuICAgICAqIEByZXR1cm4gTWluIGFuZCBtYXggY29uZnVzaW9uIG1hdHJpeCB2YWx1ZSBvciBudWxsIGlmIG5vdCBleGlzdHMuXG4gICAgICovXG4gICAgZ2V0TWluQW5kTWF4KCkge1xuICAgICAgICBsZXQgbWluID0gdGhpcy5tYXRyaXhbMF1bMF07XG4gICAgICAgIGxldCBtYXggPSB0aGlzLm1hdHJpeFswXVswXTtcbiAgICAgICAgaWYgKCFtaW4gfHwgIW1heCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgbGluZSBvZiB0aGlzLm1hdHJpeCkge1xuICAgICAgICAgICAgZm9yIChsZXQgdmFsIG9mIGxpbmUpIHtcbiAgICAgICAgICAgICAgICBtYXggPSBtYXggPCB2YWwgPyB2YWwgOiBtYXg7XG4gICAgICAgICAgICAgICAgbWluID0gbWluID4gdmFsID8gdmFsIDogbWluO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IG1pbiwgbWF4IH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldmVydHMgYWxsIG5vcm1hbGl6YXRpb25zIHBlcmZvcm1lZC5cbiAgICAgKi9cbiAgICByZXZlcnRBbGxOb3JtYWxpemF0aW9ucygpIHtcbiAgICAgICAgaWYgKHRoaXMubm9ybWFsaXphdGlvbnMgJiYgdGhpcy5ub3JtYWxpemF0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnNldENvbmZ1c2lvbk1hdHJpeCh0aGlzLm5vcm1hbGl6YXRpb25zWzBdKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSB0b3RhbCBvZiBwcmVkaWN0aW9ucyAoc2FtcGxlcykgaW4gYSBnaXZlbiBsYWJlbCBvclxuICAgICAqIG9uIGFsbCBjb25mdXNpb24gbWF0cml4LlxuICAgICAqIEBwYXJhbSBsYWJlbCBOdW1iZXIgb2YgcHJlZGljdGlvbiBmb3IgdGhlIGdpdmVuIGxhYmVsLlxuICAgICAqIElmIG51bGwsIHVuZGVmaW5lZCBvciBlbXB0eSwgcmV0dXJuIHRoZSBudW1iZXIgb2YgcHJlZGljdGlvbnNcbiAgICAgKiBmb3IgYWxsIGNvbmZ1c2lvbiBtYXRyaXguXG4gICAgICovXG4gICAgZ2V0TnVtYmVyT2ZQcmVkaWN0aW9ucyhsYWJlbCkge1xuICAgICAgICBjb25zdCBzdW1MYWJlbHMgPSB0aGlzLmdldExhYmVsc1ByZWRpY3Rpb25zU3VtKCk7XG4gICAgICAgIGlmIChsYWJlbCAmJiBsYWJlbC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMubGFiZWxzLmZpbmRJbmRleCh2YWx1ZSA9PiB2YWx1ZSA9PT0gbGFiZWwpO1xuICAgICAgICAgICAgcmV0dXJuIHN1bUxhYmVsc1tpbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBudW1iZXJPZlByZWRpY3Rpb25zID0gc3VtTGFiZWxzLnJlZHVjZSgocHJldiwgbmV4dCkgPT4gcHJldiArIG5leHQpO1xuICAgICAgICAgICAgcmV0dXJuIG51bWJlck9mUHJlZGljdGlvbnM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgc3VtIG9mIHByZWRpY3Rpb25zIGZvciBhbGwgbGFiZWxzLlxuICAgICAqIEByZXR1cm4gQXJyYXkgd2l0aCB0aGUgc3VtIG9mIHByZWRpY3Rpb25zIGZvciBhbGwgbGFiZWxzLlxuICAgICAqIFRoZSBwb3NpdGlvbiBvZiB0aGUgYXJyYXkgY29ycmVzcG9uZHMgdG8gdGhlIGxhYmVsIHBvc2l0aW9uXG4gICAgICogb24gdGhlIGNvbmZ1c2lvbiBtYXRyaXguXG4gICAgICovXG4gICAgZ2V0TGFiZWxzUHJlZGljdGlvbnNTdW0oKSB7XG4gICAgICAgIGxldCBzdW1MYWJlbHMgPSBuZXcgQXJyYXkodGhpcy5sYWJlbHMubGVuZ3RoKVxuICAgICAgICAgICAgLmZpbGwoMCwgMCwgdGhpcy5sYWJlbHMubGVuZ3RoKTtcbiAgICAgICAgdGhpcy5tYXRyaXguZm9yRWFjaCgoYXJyYXkpID0+IGFycmF5LmZvckVhY2goKHZhbHVlLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgc3VtTGFiZWxzW2luZGV4XSArPSB2YWx1ZTtcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gc3VtTGFiZWxzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBpZiB0aGUgY29uZnVzaW9uIG1hdHJpeCBpcyB2YWxpZC5cbiAgICAgKiBJZiBub3QsIGFuIGVycm9yIGRlc2NyaWJpbmcgdGhlIGlzc3VlIHdpbGwgYmUgdGhyb3duLlxuICAgICAqL1xuICAgIHZhbGlkYXRlKCkge1xuICAgICAgICBpZiAodGhpcy5sYWJlbHMubGVuZ3RoICE9PSB0aGlzLm1hdHJpeC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIGxhYmVscyBsZW5ndGggc2hvdWxkIGJlIGVxdWFscyB0byB0aGUgbWF0cml4IGNvbHVtbnMgbGVuZ3RoLicpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5sYWJlbHMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gaSArIDE7IGogPCB0aGlzLmxhYmVscy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxhYmVsc1tpXSA9PT0gdGhpcy5sYWJlbHNbal0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgbGFiZWwgJHt0aGlzLmxhYmVsc1tpXX0gYXBwZWFycyBtb3JlIHRoYW4gb25jZSBpbiB0aGUgbGFiZWxzIGFycmF5LmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1hdHJpeC5mb3JFYWNoKGFycmF5ID0+IHtcbiAgICAgICAgICAgIGlmIChhcnJheS5sZW5ndGggIT09IHRoaXMubWF0cml4Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZ1c2lvbiBtYXRyaXggZG9lcyBub3QgaGF2ZSB0aGUgY29sdW1ucy9yb3dzIGxlbmd0aC4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlZXAgY29waWVzIGEgZ2l2ZW4gb2JqZWN0LlxuICAgICAqIEBwYXJhbSBvYmplY3QgVGhlIG9iamVjdCB0byBiZSBkZWVwIGNsb25lZC5cbiAgICAgKiBAcmV0dXJuIFRoZSBkZWVwIGNsb25lZCBvYmplY3QuXG4gICAgICovXG4gICAgZGVlcENvcHkob2JqZWN0KSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iamVjdCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIHRoZSBGMSBTY29yZSBmb3JtdWxhXG4gICAgICogQHBhcmFtIHByZWNpc2lvbiBUaGUgcHJlY2lzaW9uIHZhbHVlLlxuICAgICAqIEBwYXJhbSByZWNhbGwgVGhlIHJlY2FsbCB2YWx1ZS5cbiAgICAgKi9cbiAgICBhcHBseUYxU2NvcmVGb3JtdWxhKHByZWNpc2lvbiwgcmVjYWxsKSB7XG4gICAgICAgIHJldHVybiAyICogKChwcmVjaXNpb24gKiByZWNhbGwpIC8gKHByZWNpc2lvbiArIHJlY2FsbCkpO1xuICAgIH1cbn1cbmV4cG9ydHMuQ29uZnVzaW9uTWF0cml4ID0gQ29uZnVzaW9uTWF0cml4O1xuLyoqXG4gKiBEaWZmZXJlbnQgc2l6ZXMgYXZhaWxhYmxlIGZvciB0aGUgY29uZnVzaW9uIG1hdHJpeCB2aXN1YWwgY29tcG9uZW50LlxuICovXG52YXIgQ29uZnVzaW9uTWF0cml4U2l6ZXM7XG4oZnVuY3Rpb24gKENvbmZ1c2lvbk1hdHJpeFNpemVzKSB7XG4gICAgQ29uZnVzaW9uTWF0cml4U2l6ZXNbXCJTbWFsbFwiXSA9IFwic21hbGxcIjtcbiAgICBDb25mdXNpb25NYXRyaXhTaXplc1tcIk1lZGl1bVwiXSA9IFwibWVkaXVtXCI7XG4gICAgQ29uZnVzaW9uTWF0cml4U2l6ZXNbXCJMYXJnZVwiXSA9IFwibGFyZ2VcIjtcbiAgICBDb25mdXNpb25NYXRyaXhTaXplc1tcIkV4dHJhTGFyZ2VcIl0gPSBcImV4dHJhLWxhcmdlXCI7XG59KShDb25mdXNpb25NYXRyaXhTaXplcyA9IGV4cG9ydHMuQ29uZnVzaW9uTWF0cml4U2l6ZXMgfHwgKGV4cG9ydHMuQ29uZnVzaW9uTWF0cml4U2l6ZXMgPSB7fSkpO1xuLyoqXG4gKiBEZWZpbmUgdGhlIGF2ZXJhZ2UgbWV0aG9kIHRvIGJlIHVzZSBpbiBzb21lIGNvbmZ1c2lvbiBtYXRyaXggY2FsY3VsYXRpb24uXG4gKi9cbnZhciBBdmVyYWdlTWV0aG9kO1xuKGZ1bmN0aW9uIChBdmVyYWdlTWV0aG9kKSB7XG4gICAgLyoqXG4gICAgICogQ2FsY3VsYXRlcyB0aGUgVFAsIFROLCBGUCBhbmQgRk4gZm9yIHRoZSBtYXRyaXggZ2xvYmFsbHkgYW5kIHRoZW4gYXBwbGllc1xuICAgICAqIHRoZSBjb3JyZXNwb25kIGZvcm11bGEuXG4gICAgICovXG4gICAgQXZlcmFnZU1ldGhvZFtBdmVyYWdlTWV0aG9kW1wiTWljcm9cIl0gPSAwXSA9IFwiTWljcm9cIjtcbiAgICAvKipcbiAgICAgKiBDYWxjdWxhdGVzIGFuZCBzdW1zIHRoZSB2YWx1ZSBmb3IgZWFjaCBpbmRpdmlkdWFsIGxhYmVsIGFuZCBkaXZpZGVzIGZvclxuICAgICAqIHRoZSBudW1iZXIgb2YgbGFiZWxzLlxuICAgICovXG4gICAgQXZlcmFnZU1ldGhvZFtBdmVyYWdlTWV0aG9kW1wiTWFjcm9cIl0gPSAxXSA9IFwiTWFjcm9cIjtcbiAgICAvKipcbiAgICAqIERlZmluZXMgaWYgdGhlIHZhbHVlIGNhbGN1bGF0aW9uIHNob3VsZCBiZSB3ZWlnaHRlZC4gVGhpcyBtZWFucyB0aGUgbGFiZWxzXG4gICAgKiB3aXRoIG1vcmUgcHJlZGljdGlvbnMgd2lsbCB3ZWlnaHQgbW9yZSBpbiB0aGUgZmluYWwgdmFsdWVcbiAgICAqIGNvbXBhcmluZyB3aXRoIGxhYmVscyB3aXRoIGxlc3MgcHJlZGljdGlvbnMuXG4gICAgKi9cbiAgICBBdmVyYWdlTWV0aG9kW0F2ZXJhZ2VNZXRob2RbXCJXZWlnaHRlZFwiXSA9IDJdID0gXCJXZWlnaHRlZFwiO1xufSkoQXZlcmFnZU1ldGhvZCA9IGV4cG9ydHMuQXZlcmFnZU1ldGhvZCB8fCAoZXhwb3J0cy5BdmVyYWdlTWV0aG9kID0ge30pKTtcbiIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fY3JlYXRlQmluZGluZyA9ICh0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nKSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH0pO1xufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIG9bazJdID0gbVtrXTtcbn0pKTtcbnZhciBfX2V4cG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9fZXhwb3J0U3RhcikgfHwgZnVuY3Rpb24obSwgZXhwb3J0cykge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZXhwb3J0cywgcCkpIF9fY3JlYXRlQmluZGluZyhleHBvcnRzLCBtLCBwKTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5fX2V4cG9ydFN0YXIocmVxdWlyZShcIi4vY29uZnVzaW9uLW1hdHJpeC5tb2RlbHNcIiksIGV4cG9ydHMpO1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OTApO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==